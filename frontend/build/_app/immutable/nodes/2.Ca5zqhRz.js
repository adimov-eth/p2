import"../chunks/DsnmJJEf.js";import{i as qe}from"../chunks/j-R1GFZz.js";import{d as tt,w as Ye,g as W,e as F,s as C,c as ua,o as Nt}from"../chunks/D5GmG_LJ.js";import{I as Xt,h as Je,ak as Ca,K as pa,D as fa,C as Na,i as t,a5 as Lt,F as La,H as Aa,G as ra,J as qt,S as bt,al as Da,ap as Ma,M as Wt,P as ja,O as ft,at as ma,ah as ta,_ as oe,aM as oa,aN as la,Q as ha,R as Pa,aO as At,aP as Ft,aQ as ga,aR as Dt,aS as Ha,an as Xa,aT as qa,as as Fa,aU as Oa,a3 as Ra,aV as ya,W as Ua,aW as Va,aX as _a,T as Ba,aY as Ja,aZ as Wa,Y as Ga,a_ as Ya,e as m,V as Ka,a$ as Qa,x as Fe,b0 as ke,b1 as it,m as Ae,o as we,p,y as Oe,$ as Q,t as I,z as r,B as o,A as i,v as se,b2 as ct,b3 as Xe,aL as Me,j as ge,b4 as ba,b5 as at,aK as Za,b6 as es,b7 as ts,n as as,b8 as ss}from"../chunks/OXESmFBH.js";import{p as Se,i as Z,b as wa,u as ca,s as _t,a as Le}from"../chunks/BQRKTwto.js";import{r as yt,a as ns,b as xa,s as Ke}from"../chunks/BiOPpIbk.js";function Ge(e,a){return a}function is(e,a,s){for(var l=e.items,c=[],n=a.length,v=0;v<n;v++)qa(a[v].e,c,!0);var u=n>0&&c.length===0&&s!==null;if(u){var h=s.parentNode;Fa(h),h.append(s),l.clear(),Ze(e,a[0].prev,a[n-1].next)}Oa(c,()=>{for(var k=0;k<n;k++){var g=a[k];u||(l.delete(g.k),Ze(e,g.prev,g.next)),ga(g.e,!u)}})}function We(e,a,s,l,c,n=null){var v=e,u={flags:a,items:new Map,first:null},h=(a&ya)!==0;if(h){var k=e;v=Je?Xt(Ca(k)):k.appendChild(pa())}Je&&fa();var g=null,d=!1,x=new Map,_=Lt(()=>{var N=s();return ta(N)?N:N==null?[]:ma(N)}),f,E;function S(){rs(E,f,u,x,v,c,a,l,s),n!==null&&(f.length===0?g?ha(g):g=Wt(()=>n(v)):g!==null&&Pa(g,()=>{g=null}))}Na(()=>{E??=Ra,f=t(_);var N=f.length;if(d&&N===0)return;d=N===0;let A=!1;if(Je){var P=La(v)===Aa;P!==(N===0)&&(v=ra(),Xt(v),qt(!1),A=!0)}if(Je){for(var $=null,j,y=0;y<N;y++){if(bt.nodeType===Da&&bt.data===Ma){v=bt,A=!0,qt(!1);break}var D=f[y],B=l(D,y);j=Gt(bt,u,$,null,D,B,y,c,a,s),u.items.set(B,j),$=j}N>0&&Xt(ra())}if(Je)N===0&&n&&(g=Wt(()=>n(v)));else if(ja()){var ee=new Set,X=ft;for(y=0;y<N;y+=1){D=f[y],B=l(D,y);var w=u.items.get(B)??x.get(B);w?(a&(Dt|At))!==0&&Ta(w,D,y,a):(j=Gt(null,u,null,null,D,B,y,c,a,s,!0),x.set(B,j)),ee.add(B)}for(const[q,b]of u.items)ee.has(q)||X.skipped_effects.add(b.e);X.add_callback(S)}else S();A&&qt(!0),t(_)}),Je&&(v=bt)}function rs(e,a,s,l,c,n,v,u,h){var k=(v&Va)!==0,g=(v&(Dt|At))!==0,d=a.length,x=s.items,_=s.first,f=_,E,S=null,N,A=[],P=[],$,j,y,D;if(k)for(D=0;D<d;D+=1)$=a[D],j=u($,D),y=x.get(j),y!==void 0&&(y.a?.measure(),(N??=new Set).add(y));for(D=0;D<d;D+=1){if($=a[D],j=u($,D),y=x.get(j),y===void 0){var B=l.get(j);if(B!==void 0){l.delete(j),x.set(j,B);var ee=S?S.next:f;Ze(s,S,B),Ze(s,B,ee),Ot(B,ee,c),S=B}else{var X=f?f.e.nodes_start:c;S=Gt(X,s,S,S===null?s.first:S.next,$,j,D,n,v,h)}x.set(j,S),A=[],P=[],f=S.next;continue}if(g&&Ta(y,$,D,v),(y.e.f&Ft)!==0&&(ha(y.e),k&&(y.a?.unfix(),(N??=new Set).delete(y))),y!==f){if(E!==void 0&&E.has(y)){if(A.length<P.length){var w=P[0],q;S=w.prev;var b=A[0],L=A[A.length-1];for(q=0;q<A.length;q+=1)Ot(A[q],w,c);for(q=0;q<P.length;q+=1)E.delete(P[q]);Ze(s,b.prev,L.next),Ze(s,S,b),Ze(s,L,w),f=w,S=L,D-=1,A=[],P=[]}else E.delete(y),Ot(y,f,c),Ze(s,y.prev,y.next),Ze(s,y,S===null?s.first:S.next),Ze(s,S,y),S=y;continue}for(A=[],P=[];f!==null&&f.k!==j;)(f.e.f&Ft)===0&&(E??=new Set).add(f),P.push(f),f=f.next;if(f===null)continue;y=f}A.push(y),S=y,f=y.next}if(f!==null||E!==void 0){for(var T=E===void 0?[]:ma(E);f!==null;)(f.e.f&Ft)===0&&T.push(f),f=f.next;var O=T.length;if(O>0){var ue=(v&ya)!==0&&d===0?c:null;if(k){for(D=0;D<O;D+=1)T[D].a?.measure();for(D=0;D<O;D+=1)T[D].a?.fix()}is(s,T,ue)}}k&&Ua(()=>{if(N!==void 0)for(y of N)y.a?.apply()}),e.first=s.first&&s.first.e,e.last=S&&S.e;for(var ne of l.values())ga(ne.e);l.clear()}function Ta(e,a,s,l){(l&Dt)!==0&&la(e.v,a),(l&At)!==0?la(e.i,s):e.i=s}function Gt(e,a,s,l,c,n,v,u,h,k,g){var d=(h&Dt)!==0,x=(h&Ha)===0,_=d?x?oe(c,!1,!1):oa(c):c,f=(h&At)===0?v:oa(v),E={i:f,v:_,k:n,a:null,e:null,prev:s,next:l};try{if(e===null){var S=document.createDocumentFragment();S.append(e=pa())}return E.e=Wt(()=>u(e,_,f,k),Je),E.e.prev=s&&s.e,E.e.next=l&&l.e,s===null?g||(a.first=E):(s.next=E,s.e.next=E.e),l!==null&&(l.prev=E,l.e.prev=E.e),E}finally{}}function Ot(e,a,s){for(var l=e.next?e.next.e.nodes_start:s,c=a?a.e.nodes_start:s,n=e.e.nodes_start;n!==null&&n!==l;){var v=Xa(n);c.before(n),n=v}}function Ze(e,a,s){a===null?e.first=s:(a.next=s,a.e.next=s&&s.e),s!==null&&(s.prev=a,s.e.prev=a&&a.e)}function os(e,a,s,l,c){Je&&fa();var n=a.$$slots?.[s],v=!1;n===!0&&(n=a.children,v=!0),n===void 0||n(e,v?()=>l:l)}const va=[...` 	
\r\f \v\uFEFF`];function ls(e,a,s){var l=e==null?"":""+e;if(a&&(l=l?l+" "+a:a),s){for(var c in s)if(s[c])l=l?l+" "+c:c;else if(l.length)for(var n=c.length,v=0;(v=l.indexOf(c,v))>=0;){var u=v+n;(v===0||va.includes(l[v-1]))&&(u===l.length||va.includes(l[u]))?l=(v===0?"":l.substring(0,v))+l.substring(u+1):v=u}}return l===""?null:l}function cs(e,a){return e==null?null:String(e)}function Ee(e,a,s,l,c,n){var v=e.__className;if(Je||v!==s||v===void 0){var u=ls(s,l,n);(!Je||u!==e.getAttribute("class"))&&(u==null?e.removeAttribute("class"):e.className=u),e.__className=s}else if(n&&c!==n)for(var h in n){var k=!!n[h];(c==null||k!==!!c[h])&&e.classList.toggle(h,k)}return n}function aa(e,a,s,l){var c=e.__style;if(Je||c!==a){var n=cs(a);(!Je||n!==e.getAttribute("style"))&&(n==null?e.removeAttribute("style"):e.style.cssText=n),e.__style=a}return l}function Sa(e,a,s=!1){if(e.multiple){if(a==null)return;if(!ta(a))return Ja();for(var l of e.options)l.selected=a.includes(xt(l));return}for(l of e.options){var c=xt(l);if(Wa(c,a)){l.selected=!0;return}}(!s||a!==void 0)&&(e.selectedIndex=-1)}function vs(e){var a=new MutationObserver(()=>{Sa(e,e.__value)});a.observe(e,{childList:!0,subtree:!0,attributes:!0,attributeFilter:["value"]}),Ga(()=>{a.disconnect()})}function wt(e,a,s=a){var l=!0;_a(e,"change",c=>{var n=c?"[selected]":":checked",v;if(e.multiple)v=[].map.call(e.querySelectorAll(n),xt);else{var u=e.querySelector(n)??e.querySelector("option:not([disabled])");v=u&&xt(u)}s(v)}),Ba(()=>{var c=a();if(Sa(e,c,l),l&&c===void 0){var n=e.querySelector(":checked");n!==null&&(c=xt(n),s(c))}e.__value=c,l=!1}),vs(e)}function xt(e){return"__value"in e?e.__value:e.value}function $t(e,a,s=a){var l=Ya(),c=new WeakSet;_a(e,"input",n=>{var v=n?e.defaultValue:e.value;if(v=Rt(e)?Ut(v):v,s(v),ft!==null&&c.add(ft),l&&v!==(v=a())){var u=e.selectionStart,h=e.selectionEnd;e.value=v??"",h!==null&&(e.selectionStart=u,e.selectionEnd=Math.min(h,e.value.length))}}),(Je&&e.defaultValue!==e.value||m(a)==null&&e.value)&&(s(Rt(e)?Ut(e.value):e.value),ft!==null&&c.add(ft)),Ka(()=>{var n=a();if(e===document.activeElement){var v=Qa??ft;if(c.has(v))return}Rt(e)&&n===Ut(e.value)||e.type==="date"&&!n&&!e.value||n!==e.value&&(e.value=n??"")})}function Rt(e){var a=e.type;return a==="number"||a==="range"}function Ut(e){return e===""?null:+e}function ds(e){return function(...a){var s=a[0];return s.stopPropagation(),e?.apply(this,a)}}function Ea(e,a){var s=e.$$events?.[a.type],l=ta(s)?s.slice():s==null?[]:[s];for(var c of l)c.call(this,a)}let kt=null;async function us(){return kt||(console.log("🌐 Using mock XLN module for static build compatibility"),kt=ps(),kt)}function ps(){console.log("🌐 Creating mock XLN module for browser environment");const e={replicas:new Map([["0x0000000000000000000000000000000000000000000000000000000000000001:alice",{entityId:"0x0000000000000000000000000000000000000000000000000000000000000001",signerId:"alice",state:{height:5,timestamp:Date.now(),nonces:new Map,messages:["Hello from Alice!","This is a demo message","Consensus is working!"],proposals:new Map([["prop1",{proposer:"alice",action:{type:"collective_message",data:{message:"Increase block size"}},votes:new Map([["alice","yes"],["bob","yes"]]),status:"active"}]]),config:{validators:["alice","bob","carol"],threshold:2,shares:{alice:1,bob:1,carol:1},mode:"proposer-based",jurisdiction:{name:"Ethereum",chainId:1}}},mempool:[],isProposer:!0}],["0x0000000000000000000000000000000000000000000000000000000000000001:bob",{entityId:"0x0000000000000000000000000000000000000000000000000000000000000001",signerId:"bob",state:{height:5,timestamp:Date.now(),nonces:new Map,messages:["Hello from Bob!","Consensus demo active"],proposals:new Map([["prop1",{proposer:"alice",action:{type:"collective_message",data:{message:"Increase block size"}},votes:new Map([["alice","yes"],["bob","yes"]]),status:"active"}]]),config:{validators:["alice","bob","carol"],threshold:2,shares:{alice:1,bob:1,carol:1},mode:"proposer-based",jurisdiction:{name:"Ethereum",chainId:1}}},mempool:[],isProposer:!1}]]),height:5,timestamp:Date.now(),serverInput:{serverTxs:[],entityInputs:[]}},a=[{height:1,timestamp:Date.now()-4e3,description:"Initial setup",replicas:new Map,serverInput:{serverTxs:[],entityInputs:[]},serverOutputs:[]},{height:2,timestamp:Date.now()-3e3,description:"Entity creation",replicas:e.replicas,serverInput:{serverTxs:[],entityInputs:[]},serverOutputs:[]}];return{main:async()=>(console.log("🎯 Mock XLN environment initialized"),e),applyServerInput:(s,l)=>(console.log("📨 Mock applyServerInput called"),{entityOutbox:[],mergedInputs:[]}),processUntilEmpty:(s,l)=>(console.log("🔄 Mock processUntilEmpty called"),s),runDemoWrapper:async s=>(console.log("🚀 Mock demo completed"),s),clearDatabase:async()=>{console.log("🗑️ Mock database cleared")},getHistory:()=>a,getSnapshot:s=>a[s]||null,generateSignerAvatar:s=>{const l=["#FF6B6B","#4ECDC4","#45B7D1","#96CEB4","#FFEAA7"],c=l[s.charCodeAt(0)%l.length];return`data:image/svg+xml;charset=utf-8,${encodeURIComponent(`
        <svg width="32" height="32" viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg">
          <circle cx="16" cy="16" r="16" fill="${c}"/>
          <text x="16" y="20" text-anchor="middle" fill="white" font-family="Arial" font-size="12" font-weight="bold">
            ${s.charAt(0).toUpperCase()}
          </text>
        </svg>
      `)}`},generateEntityAvatar:s=>{const l=["#6C5CE7","#A29BFE","#FD79A8","#FDCB6E","#E17055"],c=l[s.charCodeAt(0)%l.length];return`data:image/svg+xml;charset=utf-8,${encodeURIComponent(`
        <svg width="32" height="32" viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg">
          <rect width="32" height="32" rx="4" fill="${c}"/>
          <text x="16" y="20" text-anchor="middle" fill="white" font-family="Arial" font-size="10" font-weight="bold">
            #${s.slice(-2)}
          </text>
        </svg>
      `)}`},formatEntityDisplay:s=>s.startsWith("0x000000000000000000000000000000000000000000000000000000000000000")?parseInt(s.slice(-2),16).toString():s.slice(0,8),formatSignerDisplay:s=>s,createLazyEntity:async()=>({config:{}}),generateLazyEntityId:async()=>"0x1234567890abcdef",createNumberedEntity:async()=>({config:{},entityNumber:1}),generateNumberedEntityId:async()=>"0x0000000000000000000000000000000000000000000000000000000000000001"}}async function je(){return await us()}const Qe={async main(){return(await je()).main()},async applyServerInput(e,a){return(await je()).applyServerInput(e,a)},async processUntilEmpty(e,a){return(await je()).processUntilEmpty(e,a)},async createLazyEntity(e,a,s,l){return(await je()).createLazyEntity(e,a,s,l)},async generateLazyEntityId(e,a){return(await je()).generateLazyEntityId(e,a)},async createNumberedEntity(e,a,s,l){return(await je()).createNumberedEntity(e,a,s,l)},async generateNumberedEntityId(e){return(await je()).generateNumberedEntityId(e)},async runDemoWrapper(e){return(await je()).runDemoWrapper(e)},async clearDatabase(){return(await je()).clearDatabase()},async getHistory(){return(await je()).getHistory()},async getSnapshot(e){return(await je()).getSnapshot(e)},async generateSignerAvatar(e){const a=await je();return a.generateSignerAvatar?a.generateSignerAvatar(e):null},async generateEntityAvatar(e){const a=await je();return a.generateEntityAvatar?a.generateEntityAvatar(e):null},async formatEntityDisplay(e){const a=await je();return a.formatEntityDisplay?a.formatEntityDisplay(e):e},async formatSignerDisplay(e){const a=await je();return a.formatSignerDisplay?a.formatSignerDisplay(e):e}},Pe=Ye(null),zt=Ye(!0),Yt=Ye(null),ka=tt(Pe,e=>e?.replicas||new Map),gt=tt(Pe,e=>e?.history||[]),fs=tt(Pe,e=>e?.height||0),dt={async initialize(){try{zt.set(!0),Yt.set(null);const e=await Qe.main(),a=await Qe.getHistory();return e.history=Array.isArray(a)?a:[],e.serverOutputs=Array.isArray(e.serverOutputs)?e.serverOutputs:[],console.log(`🕰️ xlnStore.initialize: history length = ${e.history.length}`),Pe.set(e),zt.set(!1),console.log("🎯 XLN Environment initialized:",e),e}catch(e){const a=e instanceof Error?e.message:"Failed to initialize XLN environment";throw Yt.set(a),zt.set(!1),console.error("❌ XLN initialization failed:",e),e}},async applyServerInput(e){const a=W(Pe);if(!a)throw new Error("XLN environment not initialized");try{const s=await Qe.applyServerInput(a,{serverTxs:e.serverTxs||[],entityInputs:e.entityInputs||[]});return s.entityOutbox&&s.entityOutbox.length>0&&await Qe.processUntilEmpty(a,s.entityOutbox),Pe.set(a),s}catch(s){throw console.error("❌ Failed to apply server input:",s),s}},async submitChatMessage(e,a,s){const l=[{entityId:e,signerId:a,entityTxs:[{type:"chat",data:{from:a,message:s}}],destinations:[]}],c=W(Pe);if(c&&window.processUntilEmpty){console.log("🔥 Calling processUntilEmpty for chat");const n=window.processUntilEmpty(c,[],l);return this.updateFromEnvironment(),n}else return this.applyServerInput({entityInputs:l})},async submitProposal(e,a,s){const l=[{entityId:e,signerId:a,entityTxs:[{type:"propose",data:{action:{type:"collective_message",data:{message:s}},proposer:a}}],destinations:[]}],c=W(Pe);if(c&&window.processUntilEmpty){console.log("🔥 Calling processUntilEmpty for proposal");const n=window.processUntilEmpty(c,[],l);return this.updateFromEnvironment(),n}else return this.applyServerInput({entityInputs:l})},async submitVote(e,a,s,l,c){const n=[{entityId:e,signerId:a,entityTxs:[{type:"vote",data:{proposalId:s,voter:a,choice:l,comment:c}}],destinations:[]}],v=W(Pe);if(v&&window.processUntilEmpty){console.log("🔥 Calling processUntilEmpty for vote");const u=window.processUntilEmpty(v,[],n);return this.updateFromEnvironment(),u}else return this.applyServerInput({entityInputs:n})},async createEntity(e){try{let a,s;if(e.entityType==="lazy")a=await Qe.createLazyEntity(e.entityName,e.validators,BigInt(e.threshold),e.jurisdiction),s=await Qe.generateLazyEntityId(e.validators.map((n,v)=>({name:n,weight:1})),BigInt(e.threshold));else{const n=await Qe.createNumberedEntity(e.entityName,e.validators,BigInt(e.threshold),e.jurisdiction);a=n.config,s=await Qe.generateNumberedEntityId(n.entityNumber)}const l=e.validators.map((n,v)=>({type:"importReplica",entityId:s,signerId:n,data:{config:a,isProposer:v===0}})),c=W(Pe);if(c&&window.processUntilEmpty){console.log("🔥 Calling processUntilEmpty with serverTxs");const n=window.processUntilEmpty(c,l);return this.updateFromEnvironment(),n}else return this.applyServerInput({serverTxs:l})}catch(a){throw console.error("❌ Failed to create entity:",a),a}},async runDemo(){const e=W(Pe);if(!e)throw new Error("XLN environment not initialized");try{await Qe.runDemoWrapper(e),Pe.set(e),console.log("✅ Demo completed successfully")}catch(a){throw console.error("❌ Demo failed:",a),a}},async clearDatabase(){try{await Qe.clearDatabase(),await this.initialize(),console.log("✅ Database cleared and reinitialized")}catch(e){throw console.error("❌ Failed to clear database:",e),e}},getHistorySnapshot(e){const a=W(Pe);return!a||!a.history||e<0||e>=a.history.length?null:a.history[e]},getReplica(e,a){const s=W(ka),l=[`${e}:${a}`,`${a}:${e}`,e,a];for(const c of l){const n=s.get(c);if(n&&n.entityId===e&&n.signerId===a)return n}for(const c of s.values())if(c.entityId===e&&c.signerId===a)return c;return null}},Kt={theme:"dark",dropdownMode:"signer-first",serverDelay:0,componentStates:{}},De=Ye(Kt),Vt="xln-settings",Bt="xlnComponentStates",Tt={loadFromStorage(){try{if(typeof localStorage>"u")return;const e=localStorage.getItem(Vt);if(e){const s=JSON.parse(e);De.update(l=>({...l,...s}))}const a=localStorage.getItem(Bt);if(a){const s=JSON.parse(a);De.update(l=>({...l,componentStates:s}))}console.log("⚙️ Settings loaded from localStorage")}catch(e){console.error("❌ Failed to load settings:",e),De.set(Kt)}},saveToStorage(){try{if(typeof localStorage>"u")return;const e=W(De),{componentStates:a,...s}=e;localStorage.setItem(Vt,JSON.stringify(s)),localStorage.setItem(Bt,JSON.stringify(a)),console.log("💾 Settings saved to localStorage")}catch(e){console.error("❌ Failed to save settings:",e)}},setTheme(e){De.update(a=>({...a,theme:e})),this.saveToStorage(),typeof document<"u"&&document.documentElement.setAttribute("data-theme",e)},toggleTheme(){const e=W(De);this.setTheme(e.theme==="dark"?"light":"dark")},setDropdownMode(e){De.update(a=>({...a,dropdownMode:e})),this.saveToStorage()},toggleDropdownMode(){const e=W(De);this.setDropdownMode(e.dropdownMode==="signer-first"?"entity-first":"signer-first")},setServerDelay(e){De.update(a=>({...a,serverDelay:e})),this.saveToStorage()},getComponentState(e){const a=W(De);return a.componentStates[e]!==void 0?a.componentStates[e]:e.includes("consensus-")||e.includes("chat-")},setComponentState(e,a){De.update(s=>({...s,componentStates:{...s.componentStates,[e]:a}})),this.saveToStorage()},toggleComponentState(e){const a=this.getComponentState(e);this.setComponentState(e,!a)},resetToDefaults(){De.set(Kt),this.saveToStorage(),typeof localStorage<"u"&&(localStorage.removeItem(Vt),localStorage.removeItem(Bt))},initialize(){this.loadFromStorage();const e=W(De);typeof document<"u"&&document.documentElement.setAttribute("data-theme",e.theme)}},Re=Ye([]),lt=Ye(null),pt=Ye(1),da="xln-entity-tabs",vt={loadFromStorage(){try{if(typeof localStorage>"u")return;const e=localStorage.getItem(da);if(e){const a=JSON.parse(e);Re.set(a.tabs||[]),lt.set(a.activeTabId||null),pt.set(a.nextTabId||1),console.log("📁 Tabs loaded from localStorage:",a)}}catch(e){console.error("❌ Failed to load tabs:",e),Re.set([]),lt.set(null),pt.set(1)}},saveToStorage(){try{if(typeof localStorage>"u")return;const e={tabs:W(Re),activeTabId:W(lt),nextTabId:W(pt)};localStorage.setItem(da,JSON.stringify(e)),console.log("💾 Tabs saved to localStorage:",e)}catch(e){console.error("❌ Failed to save tabs:",e)}},generateTabId(){const e=W(pt);return pt.set(e+1),`tab-${e}`},addTab(e,a,s){const c=W(Re).length+1,n={id:this.generateTabId(),title:`Entity Panel ${c}`,jurisdiction:s||"Ethereum",signer:a||"",entityId:e||"",isActive:!1};return Re.update(v=>[...v,n]),this.setActiveTab(n.id),this.saveToStorage(),console.log("➕ Added new panel:",n),n},closeTab(e){const a=W(Re);if(console.log("❌ Closing tab:",e),a.length<=1){console.log("⚠️ Cannot close last tab");return}if(a.findIndex(n=>n.id===e)===-1)return;const l=a.filter(n=>n.id!==e);Re.set(l),W(lt)===e&&this.setActiveTab(l[0].id),this.saveToStorage()},setActiveTab(e){console.log("🎯 Setting active tab:",e),Re.update(a=>a.map(s=>({...s,isActive:s.id===e}))),lt.set(e),this.saveToStorage()},getActiveTab(){const e=W(Re),a=W(lt);return e.find(s=>s.id===a)||null},updateTab(e,a){Re.update(s=>s.map(l=>l.id===e?{...l,...a}:l)),this.saveToStorage()},getTab(e){return W(Re).find(s=>s.id===e)||null},initializeDefaultTabs(){W(Re).length===0&&(this.addTab(),this.addTab(),this.addTab())},clearAllTabs(){Re.set([]),lt.set(null),pt.set(1),this.saveToStorage()}},ms={id:"quick-start",title:"Quick Start: Create Your First Entity",description:"Get started with XLN in under 60 seconds. Create Alice's entity and send your first transaction.",difficulty:"beginner",estimatedTime:"1 minute",steps:[{id:"navigate",title:"Welcome to XLN",description:"You're now in the XLN dashboard. Let's create your first entity!",action:"wait",target:"#formationTabContent",explanation:"The formation tab is where you create new entities. Think of entities as smart wallets or organizations."},{id:"select-entity-type",title:"Choose Entity Type",description:'Select "lazy" entity type for quick setup',action:"select",target:"#entityTypeSelect",value:"lazy",explanation:"Lazy entities are perfect for testing - they work without on-chain registration."},{id:"name-entity",title:"Name Your Entity",description:"Give your entity a memorable name",action:"fill",target:"#entityNameInput",value:"My First Entity",explanation:"Entity names help you identify them in the interface. Choose something meaningful!"},{id:"select-validator",title:"Choose Validator",description:"Select Alice as your validator (the signer who can authorize transactions)",action:"click",target:'[data-validator-id="0"] .validator-selector',explanation:"Validators are the accounts that can sign transactions for this entity. Alice is a pre-configured test account."},{id:"pick-alice",title:"Pick Alice",description:"Click on alice.eth from the dropdown",action:"click",target:'#validatorOptions0 [data-signer="alice"]',explanation:"Alice is one of the test accounts available in XLN for demonstration purposes."},{id:"set-threshold",title:"Set Voting Threshold",description:"Keep threshold at 1 (Alice can act alone)",action:"fill",target:"#thresholdSlider",value:"1",explanation:"Threshold determines how many validators must agree for transactions. 1 means Alice has full control."},{id:"create-entity",title:"Create Entity",description:"Click the Create Entity button to launch your entity!",action:"click",target:'button[type="submit"]',explanation:"This creates the entity and imports it into all relevant validator accounts."},{id:"verify-creation",title:"Entity Created!",description:"Your entity is now live and ready for transactions",action:"wait",target:".entity-panel",explanation:"🎉 Congratulations! You've created your first XLN entity. You can now send messages, create proposals, and interact with other entities."}]},hs={id:"complete-workflow",title:"Complete Entity & Channel Workflow",description:"Master the full XLN experience: create entities, demonstrate governance, and prepare for channels.",difficulty:"intermediate",estimatedTime:"15 minutes",steps:[{id:"setup",title:"Navigate to XLN Dashboard",description:"Load the XLN interface and ensure the environment is ready",action:"navigate",target:"/",explanation:"The XLN dashboard provides entity formation, channel management, and consensus monitoring all in one interface."},{id:"alice-entity-type",title:"Create Alice's Simple Entity",description:'Select lazy entity type and name it "Alice Personal Wallet"',action:"select",target:"#entityTypeSelect",value:"lazy",explanation:"This creates a simple 1-of-1 entity where Alice has full control. Perfect for personal wallets or testing."},{id:"alice-entity-name",title:"Name Alice's Entity",description:'Enter "Alice Personal Wallet" as the entity name',action:"fill",target:"#entityNameInput",value:"Alice Personal Wallet"},{id:"alice-validator",title:"Set Alice as Validator",description:"Select Alice as the validator for her personal entity",action:"click",target:'[data-validator-id="0"] .validator-selector'},{id:"alice-threshold",title:"Set Threshold to 1",description:"Set voting threshold to 1 (Alice can act alone)",action:"fill",target:"#thresholdSlider",value:"1"},{id:"create-alice-entity",title:"Create Alice's Entity",description:"Click Create Entity to launch Alice's personal wallet",action:"click",target:'button[type="submit"]',explanation:"Entity creation involves cryptographic consensus. Alice's entity is now live and can receive transactions."},{id:"add-validators",title:"Create Multi-Signature Hub",description:"Add more validators for the hub entity",action:"click",target:'button[data-action="add-validator"]',explanation:"Multi-signature entities provide enhanced security. Any 2 of the 3 validators can authorize transactions."},{id:"hub-name",title:"Name the Hub",description:'Enter "Payment Hub ABC" as the hub name',action:"fill",target:"#entityNameInput",value:"Payment Hub ABC"},{id:"hub-threshold",title:"Set Hub Threshold",description:"Set threshold to 2 (requires 2 out of 3 signatures)",action:"fill",target:"#thresholdSlider",value:"2"},{id:"create-hub",title:"Create Hub Entity",description:"Click Create Entity to launch the multi-sig hub",action:"click",target:'button[type="submit"]',explanation:"The hub is now operational with 3 validator replicas. Each validator maintains their own view of the entity state."},{id:"configure-panels",title:"Configure Entity Panels",description:"Set up panels to show different validator views",action:"click",target:".entity-panel:first-child .unified-dropdown-btn",explanation:"Each panel can show a different signer's view of any entity they participate in."},{id:"send-chat",title:"Send Chat Message",description:"Demonstrate entity communication with a chat message",action:"fill",target:".controls-section textarea",value:"Hello from Alice! Ready to create channels.",explanation:"Chat messages are cryptographically signed and become part of the entity's permanent state."},{id:"create-proposal",title:"Create Channel Opening Proposal",description:"Propose to open a payment channel with the hub",action:"select",target:".controls-dropdown",value:"proposal",explanation:"Proposals enable democratic decision-making. This proposal would authorize opening a payment channel."},{id:"multi-sig-voting",title:"Demonstrate Multi-Signature Voting",description:"Other validators vote on the proposal",action:"click",target:'.vote-button[data-choice="yes"]',explanation:"With multiple YES votes, the proposal reaches quorum and will be executed automatically."},{id:"time-machine",title:"Use Time Machine",description:"Review entity history using the time machine controls",action:"click",target:'.time-btn-compact[data-action="back"]',explanation:"The time machine allows you to replay the entire entity history, perfect for audits and debugging."},{id:"completion",title:"Tutorial Complete!",description:"You've mastered entity creation and governance. Ready for channels!",action:"wait",target:".entity-panels-container",explanation:"🎉 Tutorial complete! You've created entities, demonstrated multi-signature governance, and are ready for channel operations."}]},gs={id:"multi-sig-governance",title:"Multi-Signature Governance",description:"Learn democratic decision-making with multi-signature entities.",difficulty:"intermediate",estimatedTime:"10 minutes",steps:[{id:"create-multi-sig",title:"Create Multi-Sig Entity",description:"Set up a 2-of-3 entity with Alice, Bob, and Carol",action:"select",target:"#entityTypeSelect",value:"lazy",explanation:"Multi-signature entities require multiple validators to agree before executing transactions."}]},Ct=[ms,hs,gs];function Qt(e){return Ct.find(a=>a.id===e)}const Zt=Ye(!1),mt=Ye(null),et=Ye(0),It=Ye({}),St=tt(mt,e=>e?Qt(e):null),ea=tt([St,et],([e,a])=>e?.steps[a]||null);tt([St,et],([e,a])=>e?(a+1)/e.steps.length*100:0);class ys{highlightedElement=null;startTutorial(a){const s=Qt(a);if(!s){console.error(`Tutorial not found: ${a}`);return}mt.set(a),et.set(0),Zt.set(!0),console.log(`🎯 Starting tutorial: ${s.title}`),this.applyCurrentStep()}nextStep(){const a=W(St),s=W(et);a&&(s<a.steps.length-1?(et.update(l=>l+1),this.applyCurrentStep()):this.completeTutorial())}prevStep(){W(et)>0&&(et.update(s=>s-1),this.applyCurrentStep())}executeStepAction(){const a=W(ea);if(!a)return;const s=document.querySelector(a.target);if(!s){console.warn(`🎯 Tutorial target not found: ${a.target}`);return}switch(a.action){case"click":s.click();break;case"fill":(s instanceof HTMLInputElement||s instanceof HTMLTextAreaElement)&&(s.value=a.value||"",s.dispatchEvent(new Event("input",{bubbles:!0})));break;case"select":s instanceof HTMLSelectElement&&(s.value=a.value||"",s.dispatchEvent(new Event("change",{bubbles:!0})));break;case"navigate":a.value&&(window.location.href=a.value);break}setTimeout(()=>this.nextStep(),1500)}applyCurrentStep(){const a=W(ea);if(!a)return;if(this.clearHighlight(),a.target&&a.action!=="wait"){const c=document.querySelector(a.target);c&&(this.highlightElement(c),c.scrollIntoView({behavior:"smooth",block:"center"}))}const s=W(mt),l=W(et);s&&(It.update(c=>({...c,[s]:l})),this.saveProgressToStorage())}highlightElement(a){a.classList.add("tutorial-highlight"),this.highlightedElement=a}clearHighlight(){this.highlightedElement&&(this.highlightedElement.classList.remove("tutorial-highlight"),this.highlightedElement=null)}completeTutorial(){const a=W(mt);console.log(`🎉 Tutorial completed: ${a}`),this.endTutorial(),this.showCompletionMessage()}endTutorial(){Zt.set(!1),mt.set(null),et.set(0),this.clearHighlight()}goToStep(a){const s=W(St);!s||a<0||a>=s.steps.length||(et.set(a),this.applyCurrentStep())}getTutorialProgress(a){return W(It)[a]||0}isTutorialCompleted(a){const s=Qt(a);return s?this.getTutorialProgress(a)>=s.steps.length-1:!1}saveProgressToStorage(){const a=W(It);localStorage.setItem("xln-tutorial-progress",JSON.stringify(a))}loadProgressFromStorage(){try{const a=localStorage.getItem("xln-tutorial-progress");if(a){const s=JSON.parse(a);It.set(s)}}catch(a){console.warn("Failed to load tutorial progress:",a)}}showCompletionMessage(){console.log("🎉 Tutorial completed! Great job!"),window.dispatchEvent(new CustomEvent("tutorial-completed",{detail:{tutorialId:W(mt)}}))}getAvailableTutorials(){return Ct}getTutorialsByDifficulty(a){return Ct.filter(s=>s.difficulty===a)}}const ht=new ys;ht.loadProgressFromStorage();var _s=I('<div class="progress-container svelte-19yv7yv"><div class="progress-bar svelte-19yv7yv"><div class="progress-fill svelte-19yv7yv"></div></div> <span class="progress-text svelte-19yv7yv"> </span></div>'),bs=I('<div><div class="tutorial-card-header svelte-19yv7yv"><div class="tutorial-difficulty svelte-19yv7yv"><span class="difficulty-emoji svelte-19yv7yv"> </span> <span class="difficulty-text svelte-19yv7yv"> </span></div> <div class="tutorial-time svelte-19yv7yv"> </div></div> <div class="tutorial-card-content svelte-19yv7yv"><h3 class="tutorial-card-title svelte-19yv7yv"> </h3> <p class="tutorial-card-description svelte-19yv7yv"> </p> <!></div> <div class="tutorial-card-actions svelte-19yv7yv"><button><!></button> <div class="tutorial-steps-count svelte-19yv7yv"> </div></div></div>'),ws=I('<div class="tutorial-launcher-overlay svelte-19yv7yv"><div class="tutorial-launcher-backdrop svelte-19yv7yv"></div> <div class="tutorial-launcher-panel svelte-19yv7yv"><div class="launcher-header svelte-19yv7yv"><div class="launcher-title svelte-19yv7yv"><h2 class="svelte-19yv7yv">🎯 XLN Interactive Tutorials</h2> <p class="svelte-19yv7yv">Learn XLN step-by-step with guided tutorials</p></div> <button class="launcher-close-btn svelte-19yv7yv">×</button></div> <div class="difficulty-filter svelte-19yv7yv"><label class="svelte-19yv7yv">Filter by difficulty:</label> <select class="difficulty-select svelte-19yv7yv"><option>All Tutorials</option><option>🟢 Beginner</option><option>🟡 Intermediate</option><option>🔴 Advanced</option></select></div> <div class="tutorials-grid svelte-19yv7yv"></div> <div class="launcher-footer svelte-19yv7yv"><div class="footer-note svelte-19yv7yv">💡 Tutorials are interactive and guide you through the actual XLN interface</div></div></div></div>');function xs(e,a){Fe(a,!1);const s=oe();let l=Se(a,"isVisible",12,!1),c=oe("all");function n(_){ht.startTutorial(_.id),l(!1)}function v(){l(!1)}function u(_){switch(_){case"beginner":return"🟢";case"intermediate":return"🟡";case"advanced":return"🔴";default:return"⚪"}}function h(_){return ht.getTutorialProgress(_)}function k(_){return ht.isTutorialCompleted(_)}ke(()=>(t(c),ht),()=>{Q(s,t(c)==="all"?Ct:ht.getTutorialsByDifficulty(t(c)))}),it(),qe();var g=Ae(),d=we(g);{var x=_=>{var f=ws(),E=r(f),S=o(E,2),N=r(S),A=o(r(N),2);i(N);var P=o(N,2),$=o(r(P),2);se(()=>{t(c),ct(()=>{})});var j=r($);j.value=j.__value="all";var y=o(j);y.value=y.__value="beginner";var D=o(y);D.value=D.__value="intermediate";var B=o(D);B.value=B.__value="advanced",i($),i(P);var ee=o(P,2);We(ee,5,()=>t(s),Ge,(X,w)=>{var q=bs();let b;var L=r(q),T=r(L),O=r(T),ue=r(O,!0);i(O);var ne=o(O,2),te=r(ne,!0);i(ne),i(T);var G=o(T,2),H=r(G);i(G),i(L);var Y=o(L,2),z=r(Y),K=r(z,!0);i(z);var pe=o(z,2),_e=r(pe,!0);i(pe);var Te=o(pe,2);{var ae=ce=>{var fe=_s(),ye=r(fe),be=r(ye);i(ye);var U=o(ye,2),me=r(U);i(U),i(fe),se((Ce,Ie)=>{aa(be,`width: ${Ce??""}%`),C(me,`${Ie??""} / ${t(w),m(()=>t(w).steps.length)??""} steps`)},[()=>(t(w),m(()=>h(t(w).id)/t(w).steps.length*100)),()=>(t(w),m(()=>h(t(w).id)+1))]),p(ce,fe)};Z(Te,ce=>{t(w),m(()=>h(t(w).id)>0)&&ce(ae)})}i(Y);var R=o(Y,2),re=r(R);let J;var M=r(re);{var he=ce=>{var fe=Me("✅ Restart Tutorial");p(ce,fe)},de=ce=>{var fe=Ae(),ye=we(fe);{var be=me=>{var Ce=Me("▶️ Resume Tutorial");p(me,Ce)},U=me=>{var Ce=Me("🚀 Start Tutorial");p(me,Ce)};Z(ye,me=>{t(w),m(()=>h(t(w).id)>0)?me(be):me(U,!1)},!0)}p(ce,fe)};Z(M,ce=>{t(w),m(()=>k(t(w).id))?ce(he):ce(de,!1)})}i(re);var ve=o(re,2),le=r(ve);i(ve),i(R),i(q),se((ce,fe,ye)=>{b=Ee(q,1,"tutorial-card svelte-19yv7yv",null,b,ce),C(ue,fe),C(te,(t(w),m(()=>t(w).difficulty))),C(H,`⏱️ ${t(w),m(()=>t(w).estimatedTime)??""}`),C(K,(t(w),m(()=>t(w).title))),C(_e,(t(w),m(()=>t(w).description))),J=Ee(re,1,"tutorial-start-btn svelte-19yv7yv",null,J,ye),C(le,`${t(w),m(()=>t(w).steps.length)??""} steps`)},[()=>({completed:k(t(w).id)}),()=>(t(w),m(()=>u(t(w).difficulty))),()=>({resume:h(t(w).id)>0})]),F("click",re,()=>n(t(w))),p(X,q)}),i(ee),Xe(2),i(S),i(f),F("click",E,v),F("click",A,v),wt($,()=>t(c),X=>Q(c,X)),p(_,f)};Z(d,_=>{l()&&_(x)})}p(e,g),Oe()}var Ts=I('<div class="tutorial-explanation svelte-apjo2k"><span class="tutorial-explanation-icon svelte-apjo2k">💡</span> <span class="svelte-apjo2k"> </span></div>'),Ss=I('<div class="tutorial-action-hint svelte-apjo2k"><button class="tutorial-action-btn svelte-apjo2k"><!></button></div>'),Es=I('<div class="tutorial-overlay svelte-apjo2k"><div class="tutorial-backdrop svelte-apjo2k"></div> <div class="tutorial-panel svelte-apjo2k"><div class="tutorial-header svelte-apjo2k"><div class="tutorial-progress-container svelte-apjo2k"><div class="tutorial-progress-bar svelte-apjo2k"><div class="tutorial-progress-fill svelte-apjo2k"></div></div> <span class="tutorial-step-counter svelte-apjo2k"> </span></div> <button class="tutorial-close-btn svelte-apjo2k">×</button></div> <div class="tutorial-content svelte-apjo2k"><h3 class="tutorial-title svelte-apjo2k"> </h3> <p class="tutorial-description svelte-apjo2k"> </p> <!> <!></div> <div class="tutorial-navigation svelte-apjo2k"><button class="tutorial-nav-btn tutorial-prev-btn svelte-apjo2k">← Previous</button> <button class="tutorial-skip-btn svelte-apjo2k">Skip Tutorial</button> <button class="tutorial-nav-btn tutorial-next-btn svelte-apjo2k"> </button></div></div></div>');function ks(e,a){Fe(a,!1);const s=oe(),l=oe();let c=Se(a,"isVisible",12,!1),n=Se(a,"currentStep",12,0),v=Se(a,"totalSteps",8,0),u=Se(a,"tutorialData",24,()=>[]);const h=ua();let k=oe(),g=null;Nt(()=>{console.log("🎯 Tutorial overlay mounted")});function d(){n()<v()-1&&(ca(n),E(),h("stepChanged",{step:n(),stepData:t(s)}))}function x(){n()>0&&(ca(n,-1),E(),h("stepChanged",{step:n(),stepData:t(s)}))}function _(){c(!1),S(),h("close")}function f(){if(!t(s)?.targetSelector||!t(s)?.action)return;const $=document.querySelector(t(s).targetSelector);if(!$){console.warn(`🎯 Tutorial target not found: ${t(s).targetSelector}`);return}switch(t(s).action){case"click":$.click();break;case"fill":($ instanceof HTMLInputElement||$ instanceof HTMLTextAreaElement)&&($.value=t(s).actionData||"",$.dispatchEvent(new Event("input",{bubbles:!0})));break;case"select":$ instanceof HTMLSelectElement&&($.value=t(s).actionData||"",$.dispatchEvent(new Event("change",{bubbles:!0})));break}setTimeout(d,1e3)}function E(){if(S(),!t(s)?.targetSelector||!t(s)?.highlightElement)return;const $=document.querySelector(t(s).targetSelector);$&&($.classList.add("tutorial-highlight"),g=$,$.scrollIntoView({behavior:"smooth",block:"center"}))}function S(){g&&(g.classList.remove("tutorial-highlight"),g=null)}ke(()=>(ge(u()),ge(n())),()=>{Q(s,u()[n()]||null)}),ke(()=>(ge(v()),ge(n())),()=>{Q(l,v()>0?(n()+1)/v()*100:0)}),ke(()=>(ge(c()),t(s)),()=>{c()&&t(s)&&E()}),it(),qe();var N=Ae(),A=we(N);{var P=$=>{var j=Es(),y=r(j),D=o(y,2),B=r(D),ee=r(B),X=r(ee),w=r(X);i(X);var q=o(X,2),b=r(q);i(q),i(ee);var L=o(ee,2);i(B);var T=o(B,2),O=r(T),ue=r(O,!0);i(O);var ne=o(O,2),te=r(ne,!0);i(ne);var G=o(ne,2);{var H=R=>{var re=Ts(),J=o(r(re),2),M=r(J,!0);i(J),i(re),se(()=>C(M,(t(s),m(()=>t(s).explanation)))),p(R,re)};Z(G,R=>{t(s),m(()=>t(s).explanation)&&R(H)})}var Y=o(G,2);{var z=R=>{var re=Ss(),J=r(re),M=r(J);{var he=ve=>{var le=Me("🖱️ Click for me");p(ve,le)},de=ve=>{var le=Ae(),ce=we(le);{var fe=be=>{var U=Me("✏️ Fill for me");p(be,U)},ye=be=>{var U=Ae(),me=we(U);{var Ce=$e=>{var Ue=Me("📋 Select for me");p($e,Ue)},Ie=$e=>{var Ue=Me("▶️ Do action");p($e,Ue)};Z(me,$e=>{t(s),m(()=>t(s).action==="select")?$e(Ce):$e(Ie,!1)},!0)}p(be,U)};Z(ce,be=>{t(s),m(()=>t(s).action==="fill")?be(fe):be(ye,!1)},!0)}p(ve,le)};Z(M,ve=>{t(s),m(()=>t(s).action==="click")?ve(he):ve(de,!1)})}i(J),i(re),F("click",J,f),p(R,re)};Z(Y,R=>{t(s),m(()=>t(s).action&&t(s).targetSelector)&&R(z)})}i(T);var K=o(T,2),pe=r(K),_e=o(pe,2),Te=o(_e,2),ae=r(Te,!0);i(Te),i(K),i(D),i(j),wa(j,R=>Q(k,R),()=>t(k)),se(()=>{aa(w,`width: ${t(l)??""}%`),C(b,`Step ${n()+1} of ${v()??""}`),C(ue,(t(s),m(()=>t(s).title))),C(te,(t(s),m(()=>t(s).description))),pe.disabled=n()===0,Te.disabled=n()>=v()-1,C(ae,n()>=v()-1?"Finish":"Next →")}),F("click",y,_),F("click",L,_),F("click",pe,x),F("click",_e,_),F("click",Te,d),p($,j)};Z(A,$=>{c()&&t(s)&&$(P)})}p(e,N),Oe()}var Is=I('<div class="modal-overlay svelte-1cd4pz7"><div class="modal-content svelte-1cd4pz7"><div class="modal-header svelte-1cd4pz7"><h3 class="svelte-1cd4pz7">⚙️ Settings</h3> <button class="modal-close svelte-1cd4pz7">&times;</button></div> <div class="modal-body svelte-1cd4pz7"><div class="setting-group svelte-1cd4pz7"><label for="dropdownModeToggle" class="svelte-1cd4pz7"><strong class="svelte-1cd4pz7">Dropdown Hierarchy Mode</strong> <br class="svelte-1cd4pz7"/><small class="svelte-1cd4pz7">Toggle between Jurisdiction→Signer→Entity vs Jurisdiction→Entity→Signers</small></label> <div class="toggle-switch svelte-1cd4pz7"><input type="checkbox" id="dropdownModeToggle" class="svelte-1cd4pz7"/> <span class="toggle-slider svelte-1cd4pz7"></span></div> <div class="toggle-labels svelte-1cd4pz7"><span class="svelte-1cd4pz7">Jur→Signer→Entity</span> <span class="svelte-1cd4pz7">Jur→Entity→Signers</span></div></div> <div class="setting-group svelte-1cd4pz7"><label for="serverDelaySlider" class="svelte-1cd4pz7"><strong class="svelte-1cd4pz7">Server Processing Delay</strong> <br class="svelte-1cd4pz7"/><small class="svelte-1cd4pz7">Simulate network delay in consensus processing (0ms = instant)</small></label> <div class="slider-container svelte-1cd4pz7"><input type="range" id="serverDelaySlider" min="0" max="1000" class="svelte-1cd4pz7"/> <div class="slider-value svelte-1cd4pz7"><span class="svelte-1cd4pz7"> </span> ms</div></div></div></div></div></div>'),$s=I('<div class="admin-topbar svelte-1cd4pz7"><div class="admin-logo svelte-1cd4pz7"><span class="logo-text svelte-1cd4pz7">xln</span></div> <div class="admin-navigation svelte-1cd4pz7"></div> <div class="admin-controls svelte-1cd4pz7"><button class="admin-btn svelte-1cd4pz7" title="Run Demo"><span class="svelte-1cd4pz7">▶️</span></button> <button class="admin-btn svelte-1cd4pz7" title="Clear Database"><span class="svelte-1cd4pz7">🗑️</span></button> <button class="admin-btn svelte-1cd4pz7" title="Create New Entity"><span class="svelte-1cd4pz7">➕</span></button> <button class="admin-btn admin-btn-tutorial svelte-1cd4pz7" title="Start Interactive Tutorial"><span class="svelte-1cd4pz7">🎯</span></button> <button class="admin-btn svelte-1cd4pz7" title="Add Entity Panel"><span class="svelte-1cd4pz7">📋</span></button> <button class="admin-btn svelte-1cd4pz7" title="Toggle theme"><span id="theme-icon" class="svelte-1cd4pz7"> </span></button> <button class="admin-btn svelte-1cd4pz7" title="Settings"><span class="svelte-1cd4pz7">⚙️</span></button> <button class="admin-btn svelte-1cd4pz7" title="Toggle Dropdown Mode"><span class="svelte-1cd4pz7">🔄</span></button></div></div> <!>  <!> <!>',1);function zs(e,a){Fe(a,!1);const[s,l]=_t(),c=()=>Le(De,"$settings",s),n=()=>Le(Zt,"$isActiveTutorial",s),v=()=>Le(St,"$currentTutorial",s),u=()=>Le(ea,"$currentStep",s),h=oe();let k=oe(!1),g=oe(!1);async function d(){try{await dt.runDemo(),console.log("✅ Demo completed successfully")}catch(z){console.error("❌ Demo failed:",z),alert(`Demo failed: ${z.message}`)}}async function x(){if(confirm("Are you sure you want to clear the database? This will reset all data."))try{await dt.clearDatabase(),console.log("✅ Database cleared successfully")}catch(z){console.error("❌ Clear database failed:",z),alert(`Clear database failed: ${z.message}`)}}function _(){alert("Entity Creator coming soon! Use the Controls section in any panel for now.")}function f(){Q(g,!0)}function E(){Tt.toggleTheme()}function S(){Q(k,!0)}function N(){Q(k,!1)}function A(){Tt.toggleDropdownMode()}function P(){vt.addTab()}function $(z){const K=z.target;Tt.setServerDelay(parseInt(K.value))}ke(()=>c(),()=>{Q(h,c().theme==="dark"?"🌙":"☀️")}),it(),qe();var j=$s(),y=we(j),D=o(r(y),4),B=r(D),ee=o(B,2),X=o(ee,2),w=o(X,2),q=o(w,2),b=o(q,2),L=r(b),T=r(L,!0);i(L),i(b);var O=o(b,2),ue=o(O,2);i(D),i(y);var ne=o(y,2);{var te=z=>{var K=Is(),pe=r(K),_e=r(pe),Te=o(r(_e),2);i(_e);var ae=o(_e,2),R=r(ae),re=o(r(R),2),J=r(re);yt(J),Xe(2),i(re),Xe(2),i(R);var M=o(R,2),he=o(r(M),2),de=r(he);yt(de);var ve=o(de,2),le=r(ve),ce=r(le,!0);i(le),Xe(),i(ve),i(he),i(M),i(ae),i(pe),i(K),se(()=>{ns(J,(c(),m(()=>c().dropdownMode==="entity-first"))),xa(de,(c(),m(()=>c().serverDelay))),C(ce,(c(),m(()=>c().serverDelay)))}),F("click",Te,N),F("change",J,A),F("input",de,$),F("click",pe,ds(function(fe){Ea.call(this,a,fe)})),F("click",K,N),p(z,K)};Z(ne,z=>{t(k)&&z(te)})}var G=o(ne,2);xs(G,{get isVisible(){return t(g)},set isVisible(z){Q(g,z)},$$legacy:!0});var H=o(G,2);{var Y=z=>{{let K=Lt(()=>[u()]);ks(z,{get isVisible(){return n()},currentStep:0,get totalSteps(){return v(),m(()=>v().steps.length)},get tutorialData(){return t(K)}})}};Z(H,z=>{n()&&v()&&u()&&z(Y)})}se(()=>C(T,t(h))),F("click",B,d),F("click",ee,x),F("click",X,_),F("click",w,f),F("click",q,P),F("click",b,E),F("click",O,S),F("click",ue,A),p(e,j),Oe(),l()}const He=Ye({currentTimeIndex:-1,maxTimeIndex:0,isLive:!0});tt(He,e=>e.currentTimeIndex);tt(He,e=>e.isLive);tt(He,e=>e.maxTimeIndex);const Ia=tt([He,gt,Pe],([e,a,s])=>{if(e.isLive)return s?.replicas||new Map;const l=e.currentTimeIndex;return l>=0&&l<a.length?a[l]?.replicas||new Map:new Map}),nt={updateMaxTimeIndex(){const e=W(gt),a=Math.max(0,e.length-1);He.update(s=>({...s,maxTimeIndex:a}))},goToTimeIndex(e){const a=W(He),s=Math.max(-1,Math.min(e,a.maxTimeIndex));He.set({currentTimeIndex:s,maxTimeIndex:a.maxTimeIndex,isLive:s===-1}),console.log("🕰️ Time machine moved to index:",s),this.triggerEntityPanelUpdates()},goToLive(){this.goToTimeIndex(-1)},goToHistoryStart(){this.goToTimeIndex(0)},goToHistoryEnd(){const e=W(He);this.goToTimeIndex(e.maxTimeIndex)},stepBackward(){const e=W(He);e.isLive?this.goToTimeIndex(e.maxTimeIndex):this.goToTimeIndex(Math.max(0,e.currentTimeIndex-1))},stepForward(){const e=W(He);e.isLive||(e.currentTimeIndex<e.maxTimeIndex?this.goToTimeIndex(e.currentTimeIndex+1):this.goToLive())},getCurrentSnapshot(){const e=W(He);if(e.isLive)return null;const a=W(gt);return e.currentTimeIndex>=0&&e.currentTimeIndex<a.length?a[e.currentTimeIndex]:null},getTimeInfo(){const e=W(He),a=W(gt);return e.isLive?{status:"LIVE",description:"Current time",frameNumber:a.length,totalFrames:a.length}:{status:"HISTORICAL",description:this.getCurrentSnapshot()?.description||"Historical snapshot",frameNumber:e.currentTimeIndex+1,totalFrames:a.length}},triggerEntityPanelUpdates(){window.dispatchEvent(new CustomEvent("timeChanged",{detail:{timeIndex:W(He).currentTimeIndex}}))},initialize(){this.updateMaxTimeIndex(),gt.subscribe(()=>{this.updateMaxTimeIndex()})}};var Cs=I('<div class="time-machine svelte-jwfhjw"><div class="time-machine-main svelte-jwfhjw"><div><span> </span> <span> </span> <span> </span></div> <div class="time-nav-controls svelte-jwfhjw"><button class="time-btn-compact svelte-jwfhjw" title="Step Back (← arrow)">⏪</button> <button class="time-btn-compact svelte-jwfhjw" title="Step Forward (→ arrow)">⏩</button> <button class="time-btn-compact live svelte-jwfhjw" title="Go to Current (End key)">⚡ LIVE</button></div> <div class="time-utility-controls svelte-jwfhjw"><button class="time-btn-mini svelte-jwfhjw" title="Go to Start (Home key)">⏮️</button></div></div> <div class="time-slider-container svelte-jwfhjw"><input type="range" class="time-slider svelte-jwfhjw" min="0"/></div></div>');function Ns(e,a){Fe(a,!1);const[s,l]=_t(),c=()=>Le(He,"$timeState",s),n=()=>Le(gt,"$history",s),v=()=>Le(fs,"$currentHeight",s),u=oe(),h=oe(),k=oe();function g(H,Y){if(H.isLive)return{status:"⚡ LIVE",description:"Current time",frameInfo:`Height: ${v()}`,totalFrames:`${Y.length} snapshots`};{const z=nt.getCurrentSnapshot();return{status:`📸 ${H.currentTimeIndex+1}/${Y.length}`,description:z?.description||"Historical snapshot",frameInfo:`Height: ${z?.height||0}`,totalFrames:z?.description||""}}}function d(H,Y){return H.isLive?H.maxTimeIndex+1:H.currentTimeIndex}function x(H,Y){if(H.isLive)return 100;const z=H.maxTimeIndex+1;return z>0?H.currentTimeIndex/z*100:0}function _(H){const Y=H.target,z=parseInt(Y.value),K=c().maxTimeIndex;z>K?nt.goToLive():nt.goToTimeIndex(z)}function f(){nt.stepBackward()}function E(){nt.stepForward()}function S(){nt.goToHistoryStart()}function N(){nt.goToLive()}function A(H){if(!(H.target&&H.target.tagName==="INPUT")&&!(H.target&&H.target.tagName==="TEXTAREA"))switch(H.key){case"ArrowLeft":H.preventDefault(),f();break;case"ArrowRight":H.preventDefault(),E();break;case"Home":H.preventDefault(),S();break;case"End":H.preventDefault(),N();break}}ke(()=>(c(),n()),()=>{Q(u,g(c(),n()))}),ke(()=>(c(),n()),()=>{Q(h,d(c(),n()))}),ke(()=>(c(),n()),()=>{Q(k,x(c(),n()))}),it(),qe();var P=Cs();F("keydown",ba,A);var $=r(P),j=r($);let y;var D=r(j),B=r(D,!0);i(D);var ee=o(D,2),X=r(ee,!0);i(ee);var w=o(ee,2),q=r(w,!0);i(w),i(j);var b=o(j,2),L=r(b),T=o(L,2),O=o(T,2);i(b);var ue=o(b,2),ne=r(ue);i(ue),i($);var te=o($,2),G=r(te);yt(G),i(te),i(P),se(H=>{y=Ee(j,1,"time-info-compact svelte-jwfhjw",null,y,H),C(B,(t(u),m(()=>t(u).status))),C(X,(t(u),m(()=>t(u).frameInfo))),C(q,(t(u),m(()=>t(u).totalFrames))),aa(te,`--progress: ${t(k)??""}%`),Ke(G,"max",(c(),m(()=>c().maxTimeIndex+1))),xa(G,t(h)),G.disabled=(n(),m(()=>n().length===0))},[()=>({current:c().isLive})]),F("click",L,f),F("click",T,E),F("click",O,N),F("click",ne,S),F("input",G,_),p(e,P),Oe(),l()}var Ls=I('<div><button class="unified-dropdown-btn svelte-199qdj" style="width: 100%;"><span class="dropdown-icon svelte-199qdj">🏛️</span> <span class="dropdown-text svelte-199qdj"> </span> <span class="dropdown-arrow svelte-199qdj">▼</span></button> <div></div></div>');function As(e,a){Fe(a,!1);const[s,l]=_t(),c=()=>Le(De,"$settings",s),n=()=>Le(ka,"$replicas",s),v=()=>Le(Ia,"$visibleReplicas",s),u=oe();let h=Se(a,"tab",8);const k=ua();let g=oe(!1),d=oe();function x(b){return b.entityId&&b.signer&&b.jurisdiction?`${b.jurisdiction} → ${b.signer} → ${b.entityId.slice(-4)}`:b.signer&&b.jurisdiction?`${b.jurisdiction} → ${b.signer} → Select Entity`:b.jurisdiction?`${b.jurisdiction} → Select Signer → Entity`:"Select Jurisdiction → Signer → Entity"}function _(){Q(g,!t(g)),t(g)&&f()}function f(){if(!t(d))return;at(d,t(d).innerHTML=`
      <div class="dropdown-search-container">
        <input type="text" class="dropdown-search-input" placeholder="🔍 Search jurisdictions, signers, entities..." />
      </div>
      <div class="dropdown-results" id="dropdownResults">
        <!-- Results will be populated here -->
      </div>
    `);const b=t(d).querySelector(".dropdown-search-input"),L=t(d).querySelector(".dropdown-results");b&&(b.addEventListener("input",T=>{const O=T.target;E(L,O.value)}),b.addEventListener("click",T=>{T.stopPropagation()})),E(L,"")}function E(b,L){if(!b)return;b.innerHTML="";const T=[{name:"Ethereum",id:"ethereum"},{name:"Polygon",id:"polygon"},{name:"Arbitrum",id:"arbitrum"}];c().dropdownMode==="signer-first"?S(T,b,L):N(T,b,L)}function S(b,L,T){b.forEach((O,ue)=>{const ne=Array.from(n().values()).filter(Y=>Y.state?.config?.jurisdiction?.name===O.name);if(ne.length===0)return;const te={};ne.forEach(Y=>{const z=Y.signerId;te[z]||(te[z]=[]),te[z].push(Y)});const G=A(`🏛️ ${O.name}`,"",0,!1,!1,T);L.appendChild(G);const H=Object.keys(te);H.forEach((Y,z)=>{const K=te[Y],pe=z===H.length-1,_e=A(`👤 ${Y}`,"",1,!1,pe,T);L.appendChild(_e),K.forEach((Te,ae)=>{const R=ae===K.length-1,re=Te.entityId.slice(-4),J=A(`🏢 ${re}`,`${O.name}:${Y}:${Te.entityId}`,2,!0,R&&pe,T);J.addEventListener("click",()=>$(O.name,Y,Te.entityId)),L.appendChild(J)})})})}function N(b,L,T){b.forEach((O,ue)=>{const ne=v()||n(),te=Array.from(ne.values()).filter(z=>z.state?.config?.jurisdiction?.name===O.name);if(te.length===0)return;const G={};te.forEach(z=>{const K=z.entityId;G[K]||(G[K]=[]),G[K].push(z)});const H=A(`🏛️ ${O.name}`,"",0,!1,!1,T);L.appendChild(H);const Y=Object.keys(G);Y.forEach((z,K)=>{const pe=G[z],_e=K===Y.length-1,Te=z.slice(-4),ae=A(`🏢 ${Te} (${pe.length} signers)`,"",1,!1,_e,T);L.appendChild(ae),pe.forEach((R,re)=>{const J=re===pe.length-1,M=A(`👤 ${R.signerId}`,`${O.name}:${R.signerId}:${R.entityId}`,2,!0,J&&_e,T);M.addEventListener("click",()=>$(O.name,R.signerId,R.entityId)),L.appendChild(M)})})})}function A(b,L,T,O,ue,ne){const te=document.createElement("div");te.className=`dropdown-item ${T>0?`indent-${T}`:""}`;let G="";return T===1?G="├─ ":T===2&&(G="│  └─ "),te.innerHTML=`
      <span class="tree-prefix" style="color: #666; font-family: monospace;">${G}</span>
      <span class="item-text">${b}</span>
    `,O?(te.style.cursor="pointer",te.dataset.value=L):(te.style.cursor="default",te.style.color="#9d9d9d"),ne&&b.toLowerCase().includes(ne.toLowerCase())&&P(te,ne),te}function P(b,L){const T=b.querySelector(".item-text");if(T&&L){const O=T.textContent||"",ue=new RegExp(`(${L})`,"gi");T.innerHTML=O.replace(ue,'<mark style="background: #ffd700; color: #000; padding: 2px;">$1</mark>')}}function $(b,L,T){k("entitySelect",{jurisdiction:b,signer:L,entityId:T}),Q(g,!1)}function j(b){b.target.closest(".unified-dropdown")||Q(g,!1)}ke(()=>ge(h()),()=>{Q(u,x(h()))}),it(),qe();var y=Ls();F("click",ba,j);let D;var B=r(y),ee=o(r(B),2),X=r(ee,!0);i(ee),Xe(2),i(B);var w=o(B,2);let q;wa(w,b=>Q(d,b),()=>t(d)),i(y),se((b,L)=>{D=Ee(y,1,"unified-dropdown svelte-199qdj",null,D,b),C(X,t(u)),q=Ee(w,1,"unified-dropdown-content svelte-199qdj",null,q,L)},[()=>({open:t(g)}),()=>({show:t(g)})]),F("click",B,_),p(e,y),Oe(),l()}var Ds=I('<div class="entity-profile svelte-18sk6vh"><div class="profile-info svelte-18sk6vh"><div class="profile-name svelte-18sk6vh"> </div> <div class="profile-details svelte-18sk6vh"> </div></div></div>'),Ms=I('<div class="empty-state svelte-18sk6vh">- select entity to view profile</div>'),js=I('<div class="entity-profile-section svelte-18sk6vh"><!></div>');function Ps(e,a){Fe(a,!1);let s=Se(a,"replica",8);Se(a,"tab",8),qe();var l=js(),c=r(l);{var n=u=>{var h=Ds(),k=r(h),g=r(k),d=r(g);i(g);var x=o(g,2),_=r(x);i(x),i(k),i(h),se(f=>{C(d,`Entity ${f??""}`),C(_,`Signer: ${ge(s()),m(()=>s().signerId)??""}`)},[()=>(ge(s()),m(()=>s().entityId.slice(-4)))]),p(u,h)},v=u=>{var h=Ms();p(u,h)};Z(c,u=>{s()?u(n):u(v,!1)})}i(l),p(e,l),Oe()}var Hs=I('<div class="consensus-item svelte-1udnq54"><span class="consensus-label svelte-1udnq54">Status:</span> <span class="consensus-value consensus-status-unlocked svelte-1udnq54">🔓 Unlocked</span></div> <div class="consensus-item svelte-1udnq54"><span class="consensus-label svelte-1udnq54">Role:</span> <span class="consensus-value svelte-1udnq54">👁️ Validator</span></div> <div class="consensus-item svelte-1udnq54"><span class="consensus-label svelte-1udnq54">Frame Height:</span> <span class="consensus-value svelte-1udnq54"> </span></div> <div class="consensus-item svelte-1udnq54"><span class="consensus-label svelte-1udnq54">Messages:</span> <span class="consensus-value svelte-1udnq54"> </span></div> <div class="consensus-item svelte-1udnq54"><span class="consensus-label svelte-1udnq54">Proposals:</span> <span class="consensus-value svelte-1udnq54"> </span></div>',1),Xs=I('<div class="empty-state svelte-1udnq54">- select entity to view consensus state</div>'),qs=I('<div class="consensus-state svelte-1udnq54"><!></div>');function Fs(e,a){Fe(a,!1);let s=Se(a,"replica",8);qe();var l=qs(),c=r(l);{var n=u=>{var h=Hs(),k=o(we(h),4),g=o(r(k),2),d=r(g,!0);i(g),i(k);var x=o(k,2),_=o(r(x),2),f=r(_,!0);i(_),i(x);var E=o(x,2),S=o(r(E),2),N=r(S,!0);i(S),i(E),se(()=>{C(d,(ge(s()),m(()=>s().state?.height||0))),C(f,(ge(s()),m(()=>s().state?.messages?.length||0))),C(N,(ge(s()),m(()=>s().state?.proposals?.size||0)))}),p(u,h)},v=u=>{var h=Xs();p(u,h)};Z(c,u=>{s()?u(n):u(v,!1)})}i(l),p(e,l),Oe()}var Os=I('<div class="chat-message svelte-4w744y"><div class="chat-meta svelte-4w744y"> </div> <div class="chat-content svelte-4w744y"> </div></div>'),Rs=I('<div class="empty-state svelte-4w744y">- no messages</div>'),Us=I('<div class="scrollable-component svelte-4w744y"><!></div>');function Vs(e,a){Fe(a,!1);let s=Se(a,"replica",8);Se(a,"tab",8),qe();var l=Us(),c=r(l);{var n=u=>{var h=Ae(),k=we(h);We(k,1,()=>(ge(s()),m(()=>s().state.messages)),Ge,(g,d,x)=>{var _=Os(),f=r(_),E=r(f);i(f);var S=o(f,2),N=r(S,!0);i(S),i(_),se(()=>{C(E,`Message #${x+1} • ${ge(s()),m(()=>s().signerId)??""}`),C(N,t(d))}),p(g,_)}),p(u,h)},v=u=>{var h=Rs();p(u,h)};Z(c,u=>{ge(s()),m(()=>s()&&s().state?.messages?.length>0)?u(n):u(v,!1)})}i(l),p(e,l),Oe()}var Bs=I('<div class="proposal-item svelte-1kjjzq"><div class="proposal-title svelte-1kjjzq"> </div> <div class="proposal-meta svelte-1kjjzq"><span> </span></div></div>'),Js=I('<div class="empty-state svelte-1kjjzq">- no proposals</div>'),Ws=I('<div class="scrollable-component svelte-1kjjzq"><!></div>');function Gs(e,a){Fe(a,!1);let s=Se(a,"replica",8);Se(a,"tab",8),qe();var l=Ws(),c=r(l);{var n=u=>{var h=Ae(),k=we(h);We(k,1,()=>(ge(s()),m(()=>Array.from(s().state.proposals.entries()))),Ge,(g,d)=>{var x=Za(()=>es(t(d),2));let _=()=>t(x)[1];var f=Bs(),E=r(f),S=r(E,!0);i(E);var N=o(E,2),A=r(N),P=r(A);i(A),i(N),i(f),se(()=>{C(S,(_(),m(()=>_().action?.data?.message||"Unknown proposal"))),C(P,`By: ${_(),m(()=>_().proposer||"Unknown")??""}`)}),p(g,f)}),p(u,h)},v=u=>{var h=Js();p(u,h)};Z(c,u=>{ge(s()),m(()=>s()&&s().state?.proposals?.size>0)?u(n):u(v,!1)})}i(l),p(e,l),Oe()}var Ys=I("<span>💬</span>"),Ks=I("<span>🗳️</span>"),Qs=I("<span>⚙️</span>"),Zs=I("<p><strong> </strong> </p>"),en=I("<p> </p>"),tn=I('<div class="history-item svelte-193j56j"><div class="item-icon svelte-193j56j"><!></div> <div class="item-details svelte-193j56j"><div class="item-header svelte-193j56j"><span class="item-type svelte-193j56j"> </span> <span class="item-timestamp svelte-193j56j"> </span></div> <div class="item-content svelte-193j56j"><!></div></div></div>'),an=I('<div class="history-list svelte-193j56j"></div>'),sn=I('<p class="no-history svelte-193j56j">No history available.</p>'),nn=I('<div class="transaction-history svelte-193j56j"><!></div>');function rn(e,a){Fe(a,!1);let s=Se(a,"replica",8);Se(a,"tab",8),qe();var l=nn(),c=r(l);{var n=u=>{var h=an();We(h,5,()=>(ge(s()),m(()=>s().state.messages)),Ge,(k,g)=>{var d=tn(),x=r(d),_=r(x);{var f=X=>{var w=Ys();p(X,w)},E=X=>{var w=Ae(),q=we(w);{var b=T=>{var O=Ks();p(T,O)},L=T=>{var O=Qs();p(T,O)};Z(q,T=>{t(g),m(()=>t(g).type==="proposal")?T(b):T(L,!1)},!0)}p(X,w)};Z(_,X=>{t(g),m(()=>t(g).type==="chat")?X(f):X(E,!1)})}i(x);var S=o(x,2),N=r(S),A=r(N),P=r(A,!0);i(A);var $=o(A,2),j=r($,!0);i($),i(N);var y=o(N,2),D=r(y);{var B=X=>{var w=Zs(),q=r(w),b=r(q);i(q);var L=o(q);i(w),se(()=>{C(b,`${t(g),m(()=>t(g).data.from)??""}:`),C(L,` ${t(g),m(()=>t(g).data.message)??""}`)}),p(X,w)},ee=X=>{var w=Ae(),q=we(w);{var b=L=>{var T=en(),O=r(T);i(T),se(()=>C(O,`Proposal to "${t(g),m(()=>t(g).data.action.data.message)??""}"`)),p(L,T)};Z(q,L=>{t(g),m(()=>t(g).type==="proposal")&&L(b)},!0)}p(X,w)};Z(D,X=>{t(g),m(()=>t(g).type==="chat")?X(B):X(ee,!1)})}i(y),i(S),i(d),se(X=>{C(P,(t(g),m(()=>t(g).type))),C(j,X)},[()=>(t(g),m(()=>new Date(t(g).timestamp).toLocaleTimeString()))]),p(k,d)}),i(h),p(u,h)},v=u=>{var h=sn();p(u,h)};Z(c,u=>{s()?u(n):u(v,!1)})}i(l),p(e,l),Oe()}var on=I('<div class="form-group svelte-mrxla2"><label class="form-label svelte-mrxla2">Message:</label> <textarea class="form-textarea svelte-mrxla2" placeholder="Enter your message..."></textarea></div> <button class="form-button svelte-mrxla2">Send Message</button>',1),ln=I('<div class="form-group svelte-mrxla2"><label class="form-label svelte-mrxla2">Action:</label> <div class="form-input svelte-mrxla2" style="padding: 12px; background: #1e1e1e; border-radius: 4px; color: #666;"> </div></div>'),cn=I('<div class="controls-section svelte-mrxla2"><select class="controls-dropdown svelte-mrxla2"><option selected>💬 Create chat message</option><option>📋 Add proposal</option><option>🗳️ Vote on proposal</option><option>🏛️ Form new entity</option><option>💸 Send J-tx</option><option>⚙️ Update settings</option></select> <div class="controls-form svelte-mrxla2"><!></div></div>');function vn(e,a){Se(a,"replica",8),Se(a,"tab",8);let s=oe("chat"),l=oe("");var c=cn(),n=r(c);se(()=>{t(s),ct(()=>{})});var v=r(n);v.value=v.__value="chat";var u=o(v);u.value=u.__value="proposal";var h=o(u);h.value=h.__value="vote";var k=o(h);k.value=k.__value="entity";var g=o(k);g.value=g.__value="jtx";var d=o(g);d.value=d.__value="settings",i(n);var x=o(n,2),_=r(x);{var f=S=>{var N=on(),A=we(N),P=o(r(A),2);ts(P),i(A),Xe(2),$t(P,()=>t(l),$=>Q(l,$)),p(S,N)},E=S=>{var N=ln(),A=o(r(N),2),P=r(A);i(A),i(N),se(()=>C(P,`${t(s)??""} controls will be implemented here`)),p(S,N)};Z(_,S=>{t(s)==="chat"?S(f):S(E,!1)})}i(x),i(c),wt(n,()=>t(s),S=>Q(s,S)),p(e,c)}var dn=I('<button class="panel-add-btn svelte-11c9zfd" title="Add Entity Panel">➕</button>'),un=I('<button class="panel-close-btn svelte-11c9zfd" title="Close panel">×</button>'),pn=I('<div class="entity-panel svelte-11c9zfd"><div class="panel-header svelte-11c9zfd"><!> <div class="panel-header-controls svelte-11c9zfd"><!> <!></div></div> <!> <div class="panel-component svelte-11c9zfd"><div role="button" tabindex="0"><div class="component-title svelte-11c9zfd"><span>⚖️</span> <span>Consensus State</span></div> <div class="component-toggle svelte-11c9zfd">▼</div></div> <div style="max-height: 200px;"><!></div></div> <div class="panel-component svelte-11c9zfd"><div role="button" tabindex="0"><div class="component-title svelte-11c9zfd"><span>💬</span> <span>Chat</span></div> <div class="component-toggle svelte-11c9zfd">▼</div></div> <div style="max-height: 25vh;"><!></div></div> <div class="panel-component svelte-11c9zfd"><div role="button" tabindex="0"><div class="component-title svelte-11c9zfd"><span>📋</span> <span>Proposals</span></div> <div class="component-toggle svelte-11c9zfd">▼</div></div> <div style="max-height: 25vh;"><!></div></div> <div class="panel-component entity-history-panel svelte-11c9zfd"><div role="button" tabindex="0"><div class="component-title svelte-11c9zfd"><span>🗂️</span> <span>History</span></div> <div class="component-toggle svelte-11c9zfd">▼</div></div> <div style="max-height: 40vh;"><!></div></div> <div class="panel-component svelte-11c9zfd"><div role="button" tabindex="0"><div class="component-title svelte-11c9zfd"><span>⚙️</span> <span>Controls</span></div> <div class="component-toggle svelte-11c9zfd">▼</div></div> <div style="max-height: 400px;"><!></div></div></div>');function fn(e,a){Fe(a,!1);const[s,l]=_t(),c=()=>Le(Ia,"$visibleReplicas",s),n=()=>Le(De,"$settings",s),v=oe(),u=oe(),h=oe(),k=oe(),g=oe();let d=Se(a,"tab",8),x=Se(a,"isLast",8,!1),_=oe(null);function f(U){Tt.toggleComponentState(U)}function E(U){const{jurisdiction:me,signer:Ce,entityId:Ie}=U.detail;vt.updateTab(d().id,{jurisdiction:me,signer:Ce,entityId:Ie,title:`Entity ${Ie.slice(-4)}`})}function S(){vt.closeTab(d().id)}function N(){vt.addTab()}Nt(()=>{vt.getActiveTab();const U=me=>{console.log("🕰️ EntityPanel received time change event:",me.detail.timeIndex),d().entityId&&d().signer&&console.log(`🔄 Panel ${d().id} updating for time index:`,me.detail.timeIndex)};return window.addEventListener("timeChanged",U),()=>{window.removeEventListener("timeChanged",U)}}),ke(()=>(ge(d()),c(),dt),()=>{if(d().entityId&&d().signer){const U=c()?.get?.(`${d().entityId}:${d().signer}`);Q(_,U||dt.getReplica(d().entityId,d().signer))}else Q(_,null)}),ke(()=>(n(),ge(d())),()=>{Q(v,n().componentStates[`consensus-${d().id}`]??!0)}),ke(()=>(n(),ge(d())),()=>{Q(u,n().componentStates[`chat-${d().id}`]??!0)}),ke(()=>(n(),ge(d())),()=>{Q(h,n().componentStates[`proposals-${d().id}`]??!1)}),ke(()=>(n(),ge(d())),()=>{Q(k,n().componentStates[`history-${d().id}`]??!1)}),ke(()=>(n(),ge(d())),()=>{Q(g,n().componentStates[`controls-${d().id}`]??!1)}),it(),qe();var A=pn(),P=r(A),$=r(P);As($,{get tab(){return d()},$$events:{entitySelect:E}});var j=o($,2),y=r(j);{var D=U=>{var me=dn();F("click",me,N),p(U,me)};Z(y,U=>{x()&&U(D)})}var B=o(y,2);{var ee=U=>{var me=un();F("click",me,S),p(U,me)};Z(B,U=>{U(ee)})}i(j),i(P);var X=o(P,2);Ps(X,{get replica(){return t(_)},get tab(){return d()}});var w=o(X,2),q=r(w);let b;var L=o(q,2);let T;var O=r(L);Fs(O,{get replica(){return t(_)}}),i(L),i(w);var ue=o(w,2),ne=r(ue);let te;var G=o(ne,2);let H;var Y=r(G);Vs(Y,{get replica(){return t(_)},get tab(){return d()}}),i(G),i(ue);var z=o(ue,2),K=r(z);let pe;var _e=o(K,2);let Te;var ae=r(_e);Gs(ae,{get replica(){return t(_)},get tab(){return d()}}),i(_e),i(z);var R=o(z,2),re=r(R);let J;var M=o(re,2);let he;var de=r(M);rn(de,{get replica(){return t(_)},get tab(){return d()}}),i(M),i(R);var ve=o(R,2),le=r(ve);let ce;var fe=o(le,2);let ye;var be=r(fe);vn(be,{get replica(){return t(_)},get tab(){return d()}}),i(fe),i(ve),i(A),se((U,me,Ce,Ie,$e,Ue,st,ut,rt,Mt)=>{Ke(A,"data-panel-id",(ge(d()),m(()=>d().id))),Ke(w,"id",`consensus-${ge(d()),m(()=>d().id)??""}`),b=Ee(q,1,"component-header svelte-11c9zfd",null,b,U),T=Ee(L,1,"component-content svelte-11c9zfd",null,T,me),Ke(ue,"id",`chat-${ge(d()),m(()=>d().id)??""}`),te=Ee(ne,1,"component-header svelte-11c9zfd",null,te,Ce),H=Ee(G,1,"component-content svelte-11c9zfd",null,H,Ie),Ke(z,"id",`proposals-${ge(d()),m(()=>d().id)??""}`),pe=Ee(K,1,"component-header svelte-11c9zfd",null,pe,$e),Te=Ee(_e,1,"component-content svelte-11c9zfd",null,Te,Ue),Ke(R,"id",`history-${ge(d()),m(()=>d().id)??""}`),J=Ee(re,1,"component-header svelte-11c9zfd",null,J,st),he=Ee(M,1,"component-content svelte-11c9zfd",null,he,ut),Ke(ve,"id",`controls-${ge(d()),m(()=>d().id)??""}`),ce=Ee(le,1,"component-header svelte-11c9zfd",null,ce,rt),ye=Ee(fe,1,"component-content svelte-11c9zfd",null,ye,Mt)},[()=>({collapsed:!t(v)}),()=>({collapsed:!t(v)}),()=>({collapsed:!t(u)}),()=>({collapsed:!t(u)}),()=>({collapsed:!t(h)}),()=>({collapsed:!t(h)}),()=>({collapsed:!t(k)}),()=>({collapsed:!t(k)}),()=>({collapsed:!t(g)}),()=>({collapsed:!t(g)})]),F("click",q,()=>f(`consensus-${d().id}`)),F("keydown",q,U=>U.key==="Enter"&&f(`consensus-${d().id}`)),F("click",ne,()=>f(`chat-${d().id}`)),F("keydown",ne,U=>U.key==="Enter"&&f(`chat-${d().id}`)),F("click",K,()=>f(`proposals-${d().id}`)),F("keydown",K,U=>U.key==="Enter"&&f(`proposals-${d().id}`)),F("click",re,()=>f(`history-${d().id}`)),F("keydown",re,U=>U.key==="Enter"&&f(`history-${d().id}`)),F("click",le,()=>f(`controls-${d().id}`)),F("keydown",le,U=>U.key==="Enter"&&f(`controls-${d().id}`)),p(e,A),Oe(),l()}var mn=I('<div class="input-item svelte-1fv6y8l"><strong> </strong> </div>'),hn=I('<div class="no-inputs svelte-1fv6y8l">No server transactions</div>'),gn=I("<br/> ",1),yn=I("<br/>📝 <strong> </strong> <!>",1),_n=I('<div class="input-item svelte-1fv6y8l"><strong> </strong> <!></div>'),bn=I('<div class="no-inputs svelte-1fv6y8l">No entity inputs</div>'),wn=I("<br/> ",1),xn=I("<br/>📝 <strong> </strong> <!>",1),Tn=I('<div class="input-item svelte-1fv6y8l"><strong> </strong> <!></div>'),Sn=I('<div class="no-inputs svelte-1fv6y8l">No entity outputs</div>'),En=I(`<div class="history-content svelte-1fv6y8l"><div class="server-io-container svelte-1fv6y8l"><div class="server-column svelte-1fv6y8l"><div class="server-column-header svelte-1fv6y8l">📨 Server Input (What's happening this tick) <span class="status-indicator svelte-1fv6y8l"> </span></div> <div class="server-section svelte-1fv6y8l"><h4 class="svelte-1fv6y8l">🖥️ Server Transactions</h4> <div class="server-txs-list"><!></div></div> <div class="server-section svelte-1fv6y8l"><h4 class="svelte-1fv6y8l">🔄 Entity Inputs</h4> <div class="entity-inputs-list"><!></div></div></div> <div class="server-column svelte-1fv6y8l"><div class="server-column-header svelte-1fv6y8l">📤 Server Output (What's being sent and where) <span class="status-indicator svelte-1fv6y8l"> </span></div> <div class="server-section svelte-1fv6y8l"><h4 class="svelte-1fv6y8l">🚀 Entity Outputs</h4> <div class="entity-outputs-list"><!></div></div></div></div></div>`),kn=I('<div class="history-io-section svelte-1fv6y8l"><div class="history-header svelte-1fv6y8l"><h3 class="svelte-1fv6y8l">📊 Transaction History & I/O</h3> <button> </button></div> <!></div>');function In(e,a){Fe(a,!1);const[s,l]=_t(),c=()=>Le(He,"$timeState",s),n=()=>Le(Pe,"$xlnEnvironment",s),v=oe(),u=oe(),h=oe();let k=oe(!1);function g(){Q(k,!t(k))}ke(()=>(c(),n()),()=>{Q(v,c().isLive?null:n()?.history?.[c().currentTimeIndex])}),ke(()=>t(v),()=>{Q(u,t(v)?.serverInput||{serverTxs:[],entityInputs:[]})}),ke(()=>t(v),()=>{Q(h,t(v)?.serverOutputs||[])}),it(),qe();var d=kn(),x=r(d),_=o(r(x),2);let f;var E=r(_,!0);i(_),i(x);var S=o(x,2);{var N=A=>{var P=En(),$=r(P),j=r($),y=r(j),D=o(r(y)),B=r(D,!0);i(D),i(y);var ee=o(y,2),X=o(r(ee),2),w=r(X);{var q=ae=>{var R=Ae(),re=we(R);We(re,1,()=>(t(u),m(()=>t(u).serverTxs)),Ge,(J,M)=>{var he=mn(),de=r(he),ve=r(de);i(de);var le=o(de);i(he),se(()=>{C(ve,`🖥️ ${t(M),m(()=>t(M).type)??""}`),C(le,`: ${t(M),m(()=>t(M).entityId)??""}:${t(M),m(()=>t(M).signerId)??""}
                    ${t(M),m(()=>t(M).data.isProposer?" (👑 Proposer)":" (✅ Validator)")??""}`)}),p(J,he)}),p(ae,R)},b=ae=>{var R=hn();p(ae,R)};Z(w,ae=>{t(u),m(()=>t(u).serverTxs.length>0)?ae(q):ae(b,!1)})}i(X),i(ee);var L=o(ee,2),T=o(r(L),2),O=r(T);{var ue=ae=>{var R=Ae(),re=we(R);We(re,1,()=>(t(u),m(()=>t(u).entityInputs)),Ge,(J,M)=>{var he=_n(),de=r(he),ve=r(de);i(de);var le=o(de,2);{var ce=fe=>{var ye=yn(),be=o(we(ye),2),U=r(be);i(be);var me=o(be,2);We(me,1,()=>(t(M),m(()=>t(M).entityTxs)),Ge,(Ce,Ie,$e)=>{var Ue=gn(),st=o(we(Ue));se(()=>C(st,` ${$e+1}. ${t(Ie),m(()=>t(Ie).type==="chat"?`💬 Chat: "${t(Ie).data.message}"`:t(Ie).type==="propose"?`📝 Propose: "${t(Ie).data.action.data.message}"`:t(Ie).type==="vote"?`🗳️ Vote: ${t(Ie).data.choice}`:`⚙️ ${t(Ie).type}`)??""}`)),p(Ce,Ue)}),se(()=>C(U,`${t(M),m(()=>t(M).entityTxs.length)??""} transactions:`)),p(fe,ye)};Z(le,fe=>{t(M),m(()=>t(M).entityTxs&&t(M).entityTxs.length>0)&&fe(ce)})}i(he),se(()=>C(ve,`${t(M),m(()=>t(M).entityId)??""}:${t(M),m(()=>t(M).signerId)??""}`)),p(J,he)}),p(ae,R)},ne=ae=>{var R=bn();p(ae,R)};Z(O,ae=>{t(u),m(()=>t(u).entityInputs.length>0)?ae(ue):ae(ne,!1)})}i(T),i(L),i(j);var te=o(j,2),G=r(te),H=o(r(G)),Y=r(H,!0);i(H),i(G);var z=o(G,2),K=o(r(z),2),pe=r(K);{var _e=ae=>{var R=Ae(),re=we(R);We(re,1,()=>t(h),Ge,(J,M,he)=>{var de=Tn(),ve=r(de),le=r(ve);i(ve);var ce=o(ve,2);{var fe=ye=>{var be=xn(),U=o(we(be),2),me=r(U);i(U);var Ce=o(U,2);We(Ce,1,()=>(t(M),m(()=>t(M).entityTxs)),Ge,(Ie,$e,Ue)=>{var st=wn(),ut=o(we(st));se(()=>C(ut,` ${Ue+1}. ${t($e),m(()=>t($e).type==="chat"?`💬 Chat: "${t($e).data.message}"`:t($e).type==="propose"?`📝 Propose: "${t($e).data.action.data.message}"`:t($e).type==="vote"?`🗳️ Vote: ${t($e).data.choice}`:`⚙️ ${t($e).type}`)??""}`)),p(Ie,st)}),se(()=>C(me,`${t(M),m(()=>t(M).entityTxs.length)??""} transactions:`)),p(ye,be)};Z(ce,ye=>{t(M),m(()=>t(M).entityTxs&&t(M).entityTxs.length>0)&&ye(fe)})}i(de),se(()=>C(le,`📤 ${he+1}. → ${t(M),m(()=>t(M).signerId)??""}`)),p(J,de)}),p(ae,R)},Te=ae=>{var R=Sn();p(ae,R)};Z(pe,ae=>{t(h),m(()=>t(h).length>0)?ae(_e):ae(Te,!1)})}i(K),i(z),i(te),i($),i(P),se(()=>{C(B,(c(),m(()=>c().isLive?"⚡ Current":"🕰️ Historical"))),C(Y,(c(),m(()=>c().isLive?"⚡ Current":"🕰️ Historical")))}),p(A,P)};Z(S,A=>{t(k)||A(N)})}i(d),se(A=>{f=Ee(_,1,"collapse-btn svelte-1fv6y8l",null,f,A),C(E,t(k)?"▶":"▼")},[()=>({collapsed:t(k)})]),F("click",_,g),p(e,d),Oe(),l()}var $n=I("<button><!></button>");function Jt(e,a){let s=Se(a,"variant",8,"primary"),l=Se(a,"size",8,"medium"),c=Se(a,"disabled",8,!1),n=Se(a,"type",8,"button");var v=$n(),u=r(v);os(u,a,"default",{}),i(v),se(()=>{Ee(v,1,`btn btn-${s()??""} btn-${l()??""}`,"svelte-1ygej4b"),v.disabled=c(),Ke(v,"type",n())}),F("click",v,function(h){Ea.call(this,a,h)}),p(e,v)}var zn=I("<strong>🔒 Lazy:</strong> Free to create, entityId = hash(validators), works immediately.",1),Cn=I("<strong>🔢 Numbered:</strong> Small gas cost, get sequential number like #42, on-chain registered.",1),Nn=I('<strong>🏷️ Named:</strong> Premium gas + admin approval, get custom name like "coinbase".',1),Ln=I('<button type="button" class="btn btn-danger btn-small svelte-mp6wtl">❌</button>'),An=I('<div class="validator-row svelte-mp6wtl"><select class="validator-name svelte-mp6wtl"><option>Select signer...</option><option>alice.eth</option><option>bob.eth</option><option>carol.eth</option><option>david.eth</option><option>eve.eth</option></select> <input type="number" class="validator-weight svelte-mp6wtl" min="1" placeholder="1"/> <!></div>'),Dn=I('<div class="quorum-hash-section svelte-mp6wtl"><h4 class="svelte-mp6wtl">🔐 Quorum Hash</h4> <div class="hash-display svelte-mp6wtl"><code class="svelte-mp6wtl"> </code></div> <small class="svelte-mp6wtl">This hash is calculated from your validators and threshold. It will be your entity ID.</small></div>'),Mn=I('<div class="error-message svelte-mp6wtl"> </div>'),jn=I('<div class="entity-formation svelte-mp6wtl"><div class="formation-panel svelte-mp6wtl"><div class="formation-group svelte-mp6wtl"><label for="jurisdictionSelect" class="svelte-mp6wtl">🏛️ Jurisdiction:</label> <select id="jurisdictionSelect" class="svelte-mp6wtl"><option>Ethereum Mainnet (Port 8545)</option><option>Polygon Network (Port 8546)</option><option>Arbitrum One (Port 8547)</option></select> <div class="jurisdiction-info svelte-mp6wtl"><small class="svelte-mp6wtl"><strong>📡 Network:</strong> <br/> <strong>🔗 RPC Port:</strong> </small></div></div> <div class="formation-group svelte-mp6wtl"><label for="entityTypeSelect" class="svelte-mp6wtl">🆔 Entity Type:</label> <select id="entityTypeSelect" class="svelte-mp6wtl"><option>🔒 Lazy Entity (Free - ID = Quorum Hash)</option><option>🔢 Numbered Entity (Gas Required - Sequential ID)</option><option>🏷️ Named Entity (Premium Gas + Admin Approval)</option></select> <div class="entity-type-info svelte-mp6wtl"><small class="svelte-mp6wtl"><!></small></div></div> <div class="formation-group svelte-mp6wtl"><label for="entityNameInput" class="svelte-mp6wtl">🏷️ Entity Name:</label> <input type="text" id="entityNameInput" placeholder="e.g., trading, chat, governance" class="svelte-mp6wtl"/> <small class="svelte-mp6wtl">Display name for your entity</small></div> <div class="validators-section svelte-mp6wtl"><h4 class="svelte-mp6wtl">👥 Validators:</h4> <div class="validators-list svelte-mp6wtl"></div> <button type="button" class="btn btn-secondary svelte-mp6wtl">➕ Add Validator</button> <small class="svelte-mp6wtl">💡 Start with a single signer for personal use, or add more for multisig/corporate entities</small></div> <div class="threshold-section svelte-mp6wtl"><label for="thresholdSlider" class="svelte-mp6wtl"> </label> <input type="range" id="thresholdSlider" min="1" class="threshold-slider svelte-mp6wtl"/> <div class="threshold-info svelte-mp6wtl"><span>Total Weight: <strong class="svelte-mp6wtl"> </strong></span> <span>Required: <strong class="svelte-mp6wtl"> </strong></span></div></div> <!> <div class="expected-id-section svelte-mp6wtl"><h4 class="svelte-mp6wtl">🆔 Expected Entity ID</h4> <div class="id-display svelte-mp6wtl"><code class="svelte-mp6wtl"> </code></div> <small class="svelte-mp6wtl"><!></small></div> <!> <div class="button-group svelte-mp6wtl"><button class="btn btn-primary svelte-mp6wtl"> </button> <button class="btn btn-secondary svelte-mp6wtl">🗑️ Clear Form</button></div></div></div>');function Pn(e,a){Fe(a,!1);const s=oe(),l=oe(),c=oe();let n=oe({jurisdiction:"8545",entityType:"lazy",entityName:"ACME",validators:[{name:"alice",weight:1}],threshold:1}),v=oe(!1),u=oe("");function h(){at(n,t(n).validators=[...t(n).validators,{name:"",weight:1}])}function k(V){t(n).validators.length>1&&at(n,t(n).validators=t(n).validators.filter((ie,Ne)=>Ne!==V))}function g(){const V=t(n).validators.reduce((ie,Ne)=>ie+Ne.weight,0);t(n).threshold>V&&at(n,t(n).threshold=V)}async function d(){if(!t(v)){Q(u,""),Q(v,!0);try{if(!t(n).entityName.trim())throw new Error("Entity name is required");if(t(n).validators.some(ie=>!ie.name.trim()))throw new Error("All validators must have names");const V=t(n).validators.reduce((ie,Ne)=>ie+Ne.weight,0);if(t(n).threshold>V)throw new Error("Threshold cannot exceed total weight");await dt.createEntity({entityType:t(n).entityType,entityName:t(n).entityName,validators:t(n).validators.map(ie=>ie.name),threshold:t(n).threshold,jurisdiction:t(n).jurisdiction}),x()}catch(V){Q(u,V instanceof Error?V.message:"Failed to create entity")}finally{Q(v,!1)}}}function x(){Q(n,{jurisdiction:"8545",entityType:"lazy",entityName:"ACME",validators:[{name:"alice",weight:1}],threshold:1}),Q(u,"")}function _(V,ie){const Ve=`${V.map(xe=>`${xe.name}:${xe.weight}`).sort().join(",")}|${ie}`;let ze=0;for(let xe=0;xe<Ve.length;xe++){const Be=Ve.charCodeAt(xe);ze=(ze<<5)-ze+Be,ze=ze&ze}return Math.abs(ze).toString(16).padStart(8,"0")}function f(V,ie){return V==="lazy"?`0x${ie}`:V==="numbered"?"#42":"custom-name"}ke(()=>t(n),()=>{Q(s,t(n).validators.reduce((V,ie)=>V+ie.weight,0))}),ke(()=>(t(n),t(s)),()=>{t(n).threshold>t(s)&&at(n,t(n).threshold=t(s))}),ke(()=>t(n),()=>{Q(l,t(n).entityType==="lazy"?_(t(n).validators,t(n).threshold):"")}),ke(()=>(t(n),t(l)),()=>{Q(c,f(t(n).entityType,t(l)))}),it(),qe();var E=jn(),S=r(E),N=r(S),A=o(r(N),2);se(()=>{t(n),ct(()=>{})});var P=r(A);P.value=P.__value="8545";var $=o(P);$.value=$.__value="8546";var j=o($);j.value=j.__value="8547",i(A);var y=o(A,2),D=r(y),B=o(r(D)),ee=o(B,4);i(D),i(y),i(N);var X=o(N,2),w=o(r(X),2);se(()=>{t(n),ct(()=>{})});var q=r(w);q.value=q.__value="lazy";var b=o(q);b.value=b.__value="numbered";var L=o(b);L.value=L.__value="named",i(w);var T=o(w,2),O=r(T),ue=r(O);{var ne=V=>{var ie=zn();Xe(),p(V,ie)},te=V=>{var ie=Ae(),Ne=we(ie);{var Ve=xe=>{var Be=Cn();Xe(),p(xe,Be)},ze=xe=>{var Be=Nn();Xe(),p(xe,Be)};Z(Ne,xe=>{t(n),m(()=>t(n).entityType==="numbered")?xe(Ve):xe(ze,!1)},!0)}p(V,ie)};Z(ue,V=>{t(n),m(()=>t(n).entityType==="lazy")?V(ne):V(te,!1)})}i(O),i(T),i(X);var G=o(X,2),H=o(r(G),2);yt(H),Xe(2),i(G);var Y=o(G,2),z=o(r(Y),2);We(z,5,()=>(t(n),m(()=>t(n).validators)),Ge,(V,ie,Ne)=>{var Ve=An(),ze=r(Ve);se(()=>{t(ie),ct(()=>{})});var xe=r(ze);xe.value=xe.__value="";var Be=o(xe);Be.value=Be.__value="alice";var jt=o(Be);jt.value=jt.__value="bob";var Pt=o(jt);Pt.value=Pt.__value="carol";var Ht=o(Pt);Ht.value=Ht.__value="david";var na=o(Ht);na.value=na.__value="eve",i(ze);var Et=o(ze,2);yt(Et);var $a=o(Et,2);{var za=ot=>{var ia=Ln();F("click",ia,()=>k(Ne)),p(ot,ia)};Z($a,ot=>{t(n),m(()=>t(n).validators.length>1)&&ot(za)})}i(Ve),wt(ze,()=>t(ie).name,ot=>(t(ie).name=ot,ct(()=>t(n)))),$t(Et,()=>t(ie).weight,ot=>(t(ie).weight=ot,ct(()=>t(n)))),F("input",Et,g),p(V,Ve)}),i(z);var K=o(z,2);Xe(2),i(Y);var pe=o(Y,2),_e=r(pe),Te=r(_e);i(_e);var ae=o(_e,2);yt(ae);var R=o(ae,2),re=r(R),J=o(r(re)),M=r(J,!0);i(J),i(re);var he=o(re,2),de=o(r(he)),ve=r(de,!0);i(de),i(he),i(R),i(pe);var le=o(pe,2);{var ce=V=>{var ie=Dn(),Ne=o(r(ie),2),Ve=r(Ne),ze=r(Ve,!0);i(Ve),i(Ne),Xe(2),i(ie),se(()=>C(ze,t(l))),p(V,ie)};Z(le,V=>{t(n),m(()=>t(n).entityType==="lazy")&&V(ce)})}var fe=o(le,2),ye=o(r(fe),2),be=r(ye),U=r(be,!0);i(be),i(ye);var me=o(ye,2),Ce=r(me);{var Ie=V=>{var ie=Me("This will be your entity's unique identifier, derived from the quorum hash.");p(V,ie)},$e=V=>{var ie=Ae(),Ne=we(ie);{var Ve=xe=>{var Be=Me("This will be your entity's sequential number (actual number may vary).");p(xe,Be)},ze=xe=>{var Be=Me("This will be your custom entity name (subject to admin approval).");p(xe,Be)};Z(Ne,xe=>{t(n),m(()=>t(n).entityType==="numbered")?xe(Ve):xe(ze,!1)},!0)}p(V,ie)};Z(Ce,V=>{t(n),m(()=>t(n).entityType==="lazy")?V(Ie):V($e,!1)})}i(me),i(fe);var Ue=o(fe,2);{var st=V=>{var ie=Mn(),Ne=r(ie);i(ie),se(()=>C(Ne,`❌ ${t(u)??""}`)),p(V,ie)};Z(Ue,V=>{t(u)&&V(st)})}var ut=o(Ue,2),rt=r(ut),Mt=r(rt,!0);i(rt);var sa=o(rt,2);i(ut),i(S),i(E),se(()=>{C(B,` ${t(n),m(()=>t(n).jurisdiction==="8545"?"Ethereum Mainnet":t(n).jurisdiction==="8546"?"Polygon Network":"Arbitrum One")??""}`),C(ee,` ${t(n),m(()=>t(n).jurisdiction)??""}`),C(Te,`🎯 Threshold: ${t(n),m(()=>t(n).threshold)??""}`),Ke(ae,"max",t(s)),C(M,t(s)),C(ve,(t(n),m(()=>t(n).threshold))),C(U,t(c)),rt.disabled=t(v),C(Mt,t(v)?"🔄 Creating...":"🚀 Create Entity"),sa.disabled=t(v)}),wt(A,()=>t(n).jurisdiction,V=>at(n,t(n).jurisdiction=V)),wt(w,()=>t(n).entityType,V=>at(n,t(n).entityType=V)),$t(H,()=>t(n).entityName,V=>at(n,t(n).entityName=V)),F("click",K,h),$t(ae,()=>t(n).threshold,V=>at(n,t(n).threshold=V)),F("click",rt,d),F("click",sa,x),p(e,E),Oe()}var Hn=I('<div class="entity-item svelte-eib5f9"><strong> </strong> <div class="entity-type svelte-eib5f9"> </div></div>'),Xn=I('<div class="no-entities svelte-eib5f9"> </div>'),qn=I('<div class="jurisdiction-card svelte-eib5f9"><div class="jurisdiction-header svelte-eib5f9"><h4 class="svelte-eib5f9"> </h4> <span><!></span></div> <div class="jurisdiction-details svelte-eib5f9"><div class="detail-row svelte-eib5f9"><span class="svelte-eib5f9">📡 RPC Port:</span> <span class="svelte-eib5f9"> </span></div> <div class="detail-row svelte-eib5f9"><span class="svelte-eib5f9">🔗 Chain ID:</span> <span class="svelte-eib5f9"> </span></div> <div class="detail-row svelte-eib5f9"><span class="svelte-eib5f9">📊 Block Number:</span> <span class="svelte-eib5f9"> </span></div> <div class="detail-row svelte-eib5f9"><span class="svelte-eib5f9">⏰ Last Update:</span> <span class="svelte-eib5f9"> </span></div> <div class="detail-row svelte-eib5f9"><span class="svelte-eib5f9">📝 Contract:</span> <span class="contract-address svelte-eib5f9"> </span></div> <div class="detail-row svelte-eib5f9"><span class="svelte-eib5f9">🔢 Next Entity #:</span> <span class="svelte-eib5f9"> </span></div></div> <div class="entities-section svelte-eib5f9"><h5 class="svelte-eib5f9">📋 Registered Entities:</h5> <div class="entities-list svelte-eib5f9"><!></div></div> <div class="jurisdiction-actions svelte-eib5f9"><!></div></div>'),Fn=I('<div class="jurisdictions-panel svelte-eib5f9"><h3 class="svelte-eib5f9">🏛️ Blockchain Jurisdictions Status</h3> <div class="jurisdiction-grid svelte-eib5f9"></div> <div class="global-actions svelte-eib5f9"><!> <!></div></div>');function On(e,a){Fe(a,!1);let s=oe([{port:8545,name:"Ethereum Mainnet",icon:"🔷",chainId:"31337",blockNumber:0,contractAddress:"",nextEntityNumber:1,status:"checking",lastUpdate:"",entities:[]},{port:8546,name:"Polygon Network",icon:"🟣",chainId:"31337",blockNumber:0,contractAddress:"",nextEntityNumber:1,status:"checking",lastUpdate:"",entities:[]},{port:8547,name:"Arbitrum One",icon:"🔵",chainId:"31337",blockNumber:0,contractAddress:"",nextEntityNumber:1,status:"checking",lastUpdate:"",entities:[]}]);async function l(d){d.status="checking",d.lastUpdate="Checking...";try{const x=await fetch(`http://localhost:${d.port}`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({jsonrpc:"2.0",method:"eth_blockNumber",params:[],id:1})});if(!x.ok)throw new Error("Network unavailable");const _=await x.json();if(_.error)throw new Error(_.error.message);d.blockNumber=parseInt(_.result,16),d.status="connected",d.lastUpdate=new Date().toLocaleTimeString(),d.contractAddress="0x1234...5678",d.nextEntityNumber=Math.floor(Math.random()*100)+1,d.entities=[{id:"#1",name:"Demo Entity",type:"Numbered"},{id:"#2",name:"Test Entity",type:"Numbered"}]}catch{d.status="disconnected",d.lastUpdate="Failed",d.contractAddress="Not available",d.nextEntityNumber=0,d.entities=[]}Q(s,[...t(s)])}async function c(){for(const d of t(s))await l(d)}async function n(){alert("Contract deployment feature coming soon! For now, use: cd contracts && npx hardhat ignition deploy ignition/modules/Depository.ts --network localhost")}Nt(()=>{c()}),qe();var v=Fn(),u=o(r(v),2);We(u,5,()=>t(s),Ge,(d,x)=>{var _=qn(),f=r(_),E=r(f),S=r(E);i(E);var N=o(E,2),A=r(N);{var P=J=>{var M=Me("✅ Connected");p(J,M)},$=J=>{var M=Ae(),he=we(M);{var de=le=>{var ce=Me("❌ Disconnected");p(le,ce)},ve=le=>{var ce=Me("🔄 Checking...");p(le,ce)};Z(he,le=>{t(x).status==="disconnected"?le(de):le(ve,!1)},!0)}p(J,M)};Z(A,J=>{t(x).status==="connected"?J(P):J($,!1)})}i(N),i(f);var j=o(f,2),y=r(j),D=o(r(y),2),B=r(D,!0);i(D),i(y);var ee=o(y,2),X=o(r(ee),2),w=r(X,!0);i(X),i(ee);var q=o(ee,2),b=o(r(q),2),L=r(b,!0);i(b),i(q);var T=o(q,2),O=o(r(T),2),ue=r(O,!0);i(O),i(T);var ne=o(T,2),te=o(r(ne),2),G=r(te,!0);i(te),i(ne);var H=o(ne,2),Y=o(r(H),2),z=r(Y);i(Y),i(H),i(j);var K=o(j,2),pe=o(r(K),2),_e=r(pe);{var Te=J=>{var M=Ae(),he=we(M);We(he,1,()=>t(x).entities,Ge,(de,ve)=>{var le=Hn(),ce=r(le),fe=r(ce,!0);i(ce);var ye=o(ce),be=o(ye),U=r(be,!0);i(be),i(le),se(()=>{C(fe,t(ve).id),C(ye,`: ${t(ve).name??""} `),C(U,t(ve).type)}),p(de,le)}),p(J,M)},ae=J=>{var M=Xn(),he=r(M,!0);i(M),se(()=>C(he,t(x).status==="connected"?"No entities registered yet":"Connection required")),p(J,M)};Z(_e,J=>{t(x).entities.length>0?J(Te):J(ae,!1)})}i(pe),i(K);var R=o(K,2),re=r(R);{let J=Lt(()=>t(x).status==="checking");Jt(re,{variant:"secondary",size:"small",get disabled(){return t(J)},$$events:{click:()=>l(t(x))},children:(M,he)=>{Xe();var de=Me("🔄 Refresh");p(M,de)},$$slots:{default:!0}})}i(R),i(_),se(()=>{Ke(_,"id",`jurisdiction-${t(x).port??""}`),C(S,`${t(x).icon??""} ${t(x).name??""}`),Ee(N,1,`connection-status ${t(x).status??""}`,"svelte-eib5f9"),C(B,t(x).port),C(w,t(x).chainId),C(L,t(x).blockNumber),C(ue,t(x).lastUpdate),C(G,t(x).contractAddress),C(z,`#${t(x).nextEntityNumber??""}`)}),p(d,_)}),i(u);var h=o(u,2),k=r(h);Jt(k,{variant:"primary",$$events:{click:c},children:(d,x)=>{Xe();var _=Me("🔄 Refresh All");p(d,_)},$$slots:{default:!0}});var g=o(k,2);Jt(g,{variant:"secondary",$$events:{click:n},children:(d,x)=>{Xe();var _=Me("🚀 Deploy Contracts");p(d,_)},$$slots:{default:!0}}),i(h),i(v),p(e,v),Oe()}var Rn=I('<meta name="description" content="XLN Visual Debugger - Real-time consensus monitoring and debugging interface"/>'),Un=I('<div class="loading-container svelte-1xh7afz"><div class="loading-spinner svelte-1xh7afz">🔄</div> <div class="loading-text svelte-1xh7afz">Loading XLN Environment...</div></div>'),Vn=I('<div class="error-container svelte-1xh7afz"><div class="error-icon svelte-1xh7afz">❌</div> <div class="error-text svelte-1xh7afz">Failed to load XLN Environment</div> <div class="error-details svelte-1xh7afz"> </div> <button class="retry-btn svelte-1xh7afz">Retry</button></div>'),Bn=I('<div class="main-content svelte-1xh7afz"><div class="entity-panels-container svelte-1xh7afz" id="entityPanelsContainer"></div> <!> <div class="actionable-tabs-container svelte-1xh7afz"><div class="tabs-header svelte-1xh7afz"><button id="formationTab">🏗️ Entity Formation</button> <button id="jurisdictionsTab">🏛️ Jurisdictions</button></div> <div id="formationTabContent"><!></div> <div id="jurisdictionsTabContent"><!></div></div></div> <!>',1),Jn=I('<main class="app svelte-1xh7afz"><!> <!></main>');function ei(e,a){Fe(a,!1);const[s,l]=_t(),c=()=>Le(zt,"$isLoading",s),n=()=>Le(Yt,"$error",s),v=()=>Le(Re,"$tabs",s);let u=oe("formation");function h(f){Q(u,f)}Nt(async()=>{try{console.log("🚀 Initializing XLN Svelte application..."),Tt.initialize(),vt.loadFromStorage(),vt.initializeDefaultTabs(),nt.initialize(),await dt.initialize(),console.log("✅ XLN Svelte application initialized successfully")}catch(f){console.error("❌ Failed to initialize XLN application:",f)}}),qe();var k=Jn();as(f=>{var E=Rn();ss.title="XLN Consensus Visual Debug",p(f,E)});var g=r(k);zs(g,{});var d=o(g,2);{var x=f=>{var E=Un();p(f,E)},_=f=>{var E=Ae(),S=we(E);{var N=P=>{var $=Vn(),j=o(r($),4),y=r(j,!0);i(j);var D=o(j,2);i($),se(()=>C(y,n())),F("click",D,()=>dt.initialize()),p(P,$)},A=P=>{var $=Bn(),j=we($),y=r(j);We(y,7,v,H=>H.id,(H,Y,z)=>{{let K=Lt(()=>t(z)===v().length-1);fn(H,{get tab(){return t(Y)},get isLast(){return t(K)}})}}),i(y);var D=o(y,2);In(D,{});var B=o(D,2),ee=r(B),X=r(ee);let w;var q=o(X,2);let b;i(ee);var L=o(ee,2);let T;var O=r(L);Pn(O,{}),i(L);var ue=o(L,2);let ne;var te=r(ue);On(te,{}),i(ue),i(B),i(j);var G=o(j,2);Ns(G,{}),se((H,Y,z,K)=>{Ke(y,"data-panel-count",v().length),w=Ee(X,1,"tab-button svelte-1xh7afz",null,w,H),b=Ee(q,1,"tab-button svelte-1xh7afz",null,b,Y),T=Ee(L,1,"tab-content svelte-1xh7afz",null,T,z),ne=Ee(ue,1,"tab-content svelte-1xh7afz",null,ne,K)},[()=>({active:t(u)==="formation"}),()=>({active:t(u)==="jurisdictions"}),()=>({active:t(u)==="formation"}),()=>({active:t(u)==="jurisdictions"})]),F("click",X,()=>h("formation")),F("click",q,()=>h("jurisdictions")),p(P,$)};Z(S,P=>{n()?P(N):P(A,!1)},!0)}p(f,E)};Z(d,f=>{c()?f(x):f(_,!1)})}i(k),p(e,k),Oe(),l()}export{ei as component};
